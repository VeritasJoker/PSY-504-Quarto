<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="KW">
<meta name="dcterms.date" content="2025-04-09">

<title>PSY-504-Quarto - Lab: Bayes_Lab_2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">PSY-504-Quarto</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Lab: Bayes_Lab_2</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
            <p class="subtitle lead">Princeton University</p>
                                <div class="quarto-categories">
                <div class="quarto-category">code</div>
                <div class="quarto-category">analysis</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>KW </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">April 9, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#part-3-distributions-all-the-way-down" id="toc-part-3-distributions-all-the-way-down" class="nav-link active" data-scroll-target="#part-3-distributions-all-the-way-down">Part 3: Distributions all the way down</a>
  <ul class="collapse">
  <li><a href="#setup-packages-and-data" id="toc-setup-packages-and-data" class="nav-link" data-scroll-target="#setup-packages-and-data">Setup: Packages and data</a></li>
  <li><a href="#models" id="toc-models" class="nav-link" data-scroll-target="#models">Models</a></li>
  <li><a href="#bayesians-have-many-kinds-of-distributions" id="toc-bayesians-have-many-kinds-of-distributions" class="nav-link" data-scroll-target="#bayesians-have-many-kinds-of-distributions">Bayesians have many kinds of distributions</a>
  <ul class="collapse">
  <li><a href="#question-1-how-would-you-represent-these-6-distributions-mathematically-using-p_0p-d-and-theta" id="toc-question-1-how-would-you-represent-these-6-distributions-mathematically-using-p_0p-d-and-theta" class="nav-link" data-scroll-target="#question-1-how-would-you-represent-these-6-distributions-mathematically-using-p_0p-d-and-theta">QUESTION 1: How would you represent these 6 distributions mathematically, using <span class="math inline">\(P_0\)</span>’<span class="math inline">\(P\)</span>, <span class="math inline">\(D\)</span>, <span class="math inline">\(|\)</span>, and <span class="math inline">\(\theta\)</span> ?</a></li>
  <li><a href="#answer" id="toc-answer" class="nav-link" data-scroll-target="#answer">Answer:</a></li>
  <li><a href="#likelihood-distributions." id="toc-likelihood-distributions." class="nav-link" data-scroll-target="#likelihood-distributions.">Likelihood distributions.</a></li>
  <li><a href="#prior-distributions-prior-predictive-distributions." id="toc-prior-distributions-prior-predictive-distributions." class="nav-link" data-scroll-target="#prior-distributions-prior-predictive-distributions.">Prior distributions &amp; Prior predictive distributions.</a></li>
  <li><a href="#parameter-distributions." id="toc-parameter-distributions." class="nav-link" data-scroll-target="#parameter-distributions.">Parameter distributions.</a></li>
  </ul></li>
  <li><a href="#distributions-of-the-model-expectations." id="toc-distributions-of-the-model-expectations." class="nav-link" data-scroll-target="#distributions-of-the-model-expectations.">Distributions of the model expectations.</a>
  <ul class="collapse">
  <li><a href="#posterior-predictive-distributions." id="toc-posterior-predictive-distributions." class="nav-link" data-scroll-target="#posterior-predictive-distributions.">Posterior-predictive distributions.</a></li>
  </ul></li>
  <li><a href="#bayes-rule" id="toc-bayes-rule" class="nav-link" data-scroll-target="#bayes-rule">Bayes’ rule</a></li>
  <li><a href="#default-priors" id="toc-default-priors" class="nav-link" data-scroll-target="#default-priors">Default priors</a></li>
  <li><a href="#question-2-are-the-priors-the-same-what-do-you-think-is-going-on" id="toc-question-2-are-the-priors-the-same-what-do-you-think-is-going-on" class="nav-link" data-scroll-target="#question-2-are-the-priors-the-same-what-do-you-think-is-going-on">QUESTION 2 Are the priors the same? What do you think is going on?</a>
  <ul class="collapse">
  <li><a href="#answer-1" id="toc-answer-1" class="nav-link" data-scroll-target="#answer-1">Answer:</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#exercise-1" id="toc-exercise-1" class="nav-link" data-scroll-target="#exercise-1">EXERCISE 1</a>
  <ul class="collapse">
  <li><a href="#answer-your-solution-below" id="toc-answer-your-solution-below" class="nav-link" data-scroll-target="#answer-your-solution-below">Answer/ Your solution below:</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  <li><a href="#session-information" id="toc-session-information" class="nav-link" data-scroll-target="#session-information">Session information</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="Bayes_Lab_2.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>For Lab 1, you had explored the data and looked at models built via lm() and via brms(using default priors). You had also drawn posterior samples after fitting the model.</p>
<p>For Lab 2, we continue with the Palmer Penguins. And we will look more at distributions and priors.</p>
<p>Again, there will be conceptual questions to answer as you work through this example, and exercises.</p>
<section id="part-3-distributions-all-the-way-down" class="level1">
<h1>Part 3: Distributions all the way down</h1>
<p>Given it’s a continuation of Lab 1, let’s begin by loading relevant packages, cleaning/pre-processing the data, and fitting lm() and the default brm models</p>
<section id="setup-packages-and-data" class="level2">
<h2 class="anchored" data-anchor-id="setup-packages-and-data">Setup: Packages and data</h2>
<p>We load the primary packages.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We want the same data set up as in the last lab.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the penguins data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(penguins, <span class="at">package =</span> <span class="st">"palmerpenguins"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># subset the data</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>chinstrap <span class="ot">&lt;-</span> penguins <span class="sc">%&gt;%</span> </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Chinstrap"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(chinstrap)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 68
Columns: 8
$ species           &lt;fct&gt; Chinstrap, Chinstrap, Chinstrap, Chinstrap, Chinstra…
$ island            &lt;fct&gt; Dream, Dream, Dream, Dream, Dream, Dream, Dream, Dre…
$ bill_length_mm    &lt;dbl&gt; 46.5, 50.0, 51.3, 45.4, 52.7, 45.2, 46.1, 51.3, 46.0…
$ bill_depth_mm     &lt;dbl&gt; 17.9, 19.5, 19.2, 18.7, 19.8, 17.8, 18.2, 18.2, 18.9…
$ flipper_length_mm &lt;int&gt; 192, 196, 193, 188, 197, 198, 178, 197, 195, 198, 19…
$ body_mass_g       &lt;int&gt; 3500, 3900, 3650, 3525, 3725, 3950, 3250, 3750, 4150…
$ sex               &lt;fct&gt; female, male, male, female, male, female, female, ma…
$ year              &lt;int&gt; 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007…</code></pre>
</div>
</div>
</section>
<section id="models" class="level2">
<h2 class="anchored" data-anchor-id="models">Models</h2>
<p>Once again, we’ll fit the model</p>
<p><span class="math display">\[
\begin{aligned}
\text{bill\_length\_mm}_i &amp; = \beta_0 + \beta_1 \text{body\_mass\_g}_i + \epsilon_i \\
\epsilon_i &amp; \sim \operatorname{Normal}(0, \sigma_\epsilon) ,
\end{aligned}
\]</span></p>
<p>with both <code>lm()</code> and <code>brm()</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># OLS</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>fit1.ols <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> chinstrap,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  bill_length_mm <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> body_mass_g</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Bayes</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>fit1.b <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> chinstrap,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  bill_length_mm <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> body_mass_g</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="bayesians-have-many-kinds-of-distributions" class="level2">
<h2 class="anchored" data-anchor-id="bayesians-have-many-kinds-of-distributions">Bayesians have many kinds of distributions</h2>
<p>In Bayesian statistics, we have at least 6 distributions to keep track of. Those are:</p>
<ul>
<li>the likelihood distributions</li>
<li>the prior parameter distribution (aka priors)</li>
<li>the prior predictive distributions</li>
<li>the posterior parameter distributions (aka posteriors)</li>
<li>the posterior-predictive distribution</li>
</ul>
<p>In many respect, it’s distributions ‘all the way down,’ with Bayesians. This can be indeed be difficult to keep track of at first. But since this is true for any class of Bayesian models (not just regression), you’ll hopefully get used to it.<br>
</p>
<section id="question-1-how-would-you-represent-these-6-distributions-mathematically-using-p_0p-d-and-theta" class="level3">
<h3 class="anchored" data-anchor-id="question-1-how-would-you-represent-these-6-distributions-mathematically-using-p_0p-d-and-theta">QUESTION 1: How would you represent these 6 distributions mathematically, using <span class="math inline">\(P_0\)</span>’<span class="math inline">\(P\)</span>, <span class="math inline">\(D\)</span>, <span class="math inline">\(|\)</span>, and <span class="math inline">\(\theta\)</span> ?</h3>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Hint 1: Many of these terms were in the Bayes Rule.</p>
</div>
</div>
</section>
<section id="answer" class="level3">
<h3 class="anchored" data-anchor-id="answer">Answer:</h3>
<p>Likelihood: <span class="math inline">\(P(D|\theta)\)</span></p>
<p>Prior parameter distribution: <span class="math inline">\(P_0(\theta)\)</span></p>
<p>Prior predictive distribution <span class="math inline">\(P0_0(D)=\int P(D∣\theta)P_0​(\theta)d\theta\)</span></p>
<p>Posterior parameter distribution: <span class="math inline">\(P(\theta∣D)\)</span></p>
<p>Posterior predictive distribution: <span class="math inline">\(P(D_n​∣D)=\int P(D_n​∣\theta)P(\theta∣D)d\theta\)</span></p>
<p>We also have some other distributions that follow from these. For example, - the distributions of the model expectations (i.e., the predicted means)</p>
</section>
<section id="likelihood-distributions." class="level3">
<h3 class="anchored" data-anchor-id="likelihood-distributions.">Likelihood distributions.</h3>
<p>We are approaching Bayesian statistics from a likelihood-based perspective. That is, we situate regression models within the greater context of a likelihood function. (There are ways to do non-parametric Bayesian statistics, which don’t focus on likelihoods. We won’t get into that right now.)</p>
<p>So far, we have been using the conventional Gaussian likelihood. If we have some variable <span class="math inline">\(y\)</span>, we can express it as normally distributed by</p>
<p><span class="math display">\[
\operatorname{Normal}(y \mid \mu, \sigma) = \frac{1}{\sqrt{2 \pi \sigma}} \exp \left( \frac{1}{2} \left( \frac{y - \mu}{\sigma}\right)^2\right),
\]</span></p>
<p>where <span class="math inline">\(\mu\)</span> is the mean and <span class="math inline">\(\sigma\)</span> is the standard deviation. With this likelihood,</p>
<ul>
<li><span class="math inline">\(\mu \in \mathbb R\)</span>
<ul>
<li>the mean can be any real number, ranging from <span class="math inline">\(-\infty\)</span> to <span class="math inline">\(\infty\)</span></li>
</ul></li>
<li><span class="math inline">\(\sigma \in \mathbb R_{&gt; 0}\)</span>
<ul>
<li>the standard deviation can take on any real number greater than zero.</li>
</ul></li>
</ul>
<p>It’s also the assumption</p>
<ul>
<li><span class="math inline">\(y \in \mathbb R\)</span>
<ul>
<li>the focal variable <span class="math inline">\(y\)</span> can be any real number, ranging from <span class="math inline">\(-\infty\)</span> to <span class="math inline">\(\infty\)</span>.</li>
</ul></li>
</ul>
<p>One of the ways we wrote our model formula back in the first file was</p>
<p><span class="math display">\[
\begin{aligned}
\text{bill\_length\_mm}_i &amp; \sim \operatorname{Normal}(\mu_i, \sigma) \\
\mu_i &amp; = \beta_0 + \beta_1 \text{body\_mass\_g}_i,
\end{aligned}
\]</span></p>
<p>and further in the discussion, we updated that equation with the posterior means for our three parameters to</p>
<p><span class="math display">\[
\begin{aligned}
\text{bill\_length\_mm}_i &amp; \sim \operatorname{Normal}(\mu_i, 2.92) \\
\mu_i &amp; = 32.2 + 0.004 \text{body\_mass\_g}_i.
\end{aligned}
\]</span></p>
<p>Before we get into this, though, let’s back up and consider an intercept-only model of the form</p>
<p><span class="math display">\[
\begin{aligned}
\text{bill\_length\_mm}_i &amp; \sim \operatorname{Normal}(\mu_i, \sigma) \\
\mu_i &amp; = \beta_0 ,
\end{aligned}
\]</span></p>
<p>where there is no predictor variable. Here’s how to fit the model with <code>brm()</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bayes</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>fit0.b <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> chinstrap,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  bill_length_mm <span class="sc">~</span> <span class="dv">1</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Let’s look at the model summary.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit0.b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: bill_length_mm ~ 1 
   Data: chinstrap (Number of observations: 68) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Regression Coefficients:
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept    48.85      0.40    48.05    49.65 1.00     2944     2309

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     3.37      0.29     2.88     4.00 1.00     2916     2234

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<p>The intercept parameter <span class="math inline">\(\beta_0\)</span> is a stand-in for <span class="math inline">\(\mu\)</span>. The <span class="math inline">\(\sigma\)</span> parameter is just <span class="math inline">\(\sigma\)</span>. Here they are in a plot.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit0.b) </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">beta[0]==mu</span><span class="st">`</span> <span class="ot">=</span> b_Intercept) <span class="sc">%&gt;%</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="st">`</span><span class="at">beta[0]==mu</span><span class="st">`</span><span class="sc">:</span>sigma, <span class="at">names_to =</span> <span class="st">"parameter"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">.width =</span> .<span class="dv">95</span>, <span class="at">normalize =</span> <span class="st">"panels"</span>) <span class="sc">+</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"parameter space"</span>) <span class="sc">+</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> parameter, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">labeller =</span> label_parsed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bayes_Lab_2_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Here are the posterior means for those two parameters.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">mean</span>(draws<span class="sc">$</span>b_Intercept)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">mean</span>(draws<span class="sc">$</span>sigma)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>mu; sigma</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 48.8517</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.374678</code></pre>
</div>
</div>
<p>We can use <code>dnorm()</code> to compute the shape of <span class="math inline">\(\operatorname{Normal}(48.8, 3.4)\)</span>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">y =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">30</span>, <span class="at">to =</span> <span class="dv">70</span>, <span class="at">by =</span> <span class="fl">0.1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density =</span> <span class="fu">dnorm</span>(<span class="at">x =</span> y, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> y, <span class="at">y =</span> density)) <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"bill_length_mm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bayes_Lab_2_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>We can compare this to the sample distribution of the <code>bill_length_mm</code> data:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>chinstrap <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm)) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)),</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">binwidth =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">bill_length_mm =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">30</span>, <span class="at">to =</span> <span class="dv">70</span>, <span class="at">by =</span> <span class="fl">0.1</span>)),</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">dnorm</span>(<span class="at">x =</span> bill_length_mm, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma)),</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bayes_Lab_2_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>It’s not a great fit, but not horrible either.</p>
<p>Now let’s see what this means for our univariable model <code>fit1.b</code>. First, let’s learn about the <code>posterior_summary()</code> function, which we’ll use to save a few posterior means.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(fit1.b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   Estimate   Est.Error          Q2.5         Q97.5
b_Intercept    3.217323e+01 3.460231038  2.536711e+01  3.898989e+01
b_body_mass_g  4.466618e-03 0.000925384  2.666726e-03  6.312262e-03
sigma          2.934212e+00 0.261954441  2.478489e+00  3.501761e+00
Intercept      4.884751e+01 0.355044833  4.813830e+01  4.953091e+01
lprior        -4.300398e+00 0.070510527 -4.454670e+00 -4.184566e+00
lp__          -1.723229e+02 1.258248937 -1.756687e+02 -1.708992e+02</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>b0    <span class="ot">&lt;-</span> <span class="fu">posterior_summary</span>(fit1.b)[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>b1    <span class="ot">&lt;-</span> <span class="fu">posterior_summary</span>(fit1.b)[<span class="dv">2</span>, <span class="dv">1</span>]</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">posterior_summary</span>(fit1.b)[<span class="dv">3</span>, <span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now we plot.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">crossing</span>(<span class="at">body_mass_g    =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">2500</span>, <span class="at">to =</span> <span class="dv">5000</span>, <span class="at">length.out =</span> <span class="dv">200</span>),</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">bill_length_mm =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">35</span>, <span class="at">to =</span> <span class="dv">60</span>, <span class="at">length.out =</span> <span class="dv">200</span>))  <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density =</span> <span class="fu">dnorm</span>(<span class="at">x =</span> bill_length_mm, </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">mean =</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> body_mass_g,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sd =</span> sigma)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g, <span class="at">y =</span> bill_length_mm)) <span class="sc">+</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">fill =</span> density),</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">interpolate =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> chinstrap,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">fill =</span> <span class="st">"black"</span>, <span class="at">stroke =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"A"</span>, <span class="at">begin =</span> .<span class="dv">15</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">range</span>(chinstrap<span class="sc">$</span>body_mass_g),</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">range</span>(chinstrap<span class="sc">$</span>bill_length_mm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bayes_Lab_2_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Our univariable model <code>fit1.b</code> can be viewed as something like a 3-dimensional Gaussian hill.</p>
</section>
<section id="prior-distributions-prior-predictive-distributions." class="level3">
<h3 class="anchored" data-anchor-id="prior-distributions-prior-predictive-distributions.">Prior distributions &amp; Prior predictive distributions.</h3>
<p>Let’s hold off on this for a bit.</p>
</section>
<section id="parameter-distributions." class="level3">
<h3 class="anchored" data-anchor-id="parameter-distributions.">Parameter distributions.</h3>
<p>Up above, we plotted the posterior distributions for our intercept-only <code>fit0.b</code> model. Here they are again.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>draws <span class="sc">%&gt;%</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">beta[0]==mu</span><span class="st">`</span> <span class="ot">=</span> b_Intercept) <span class="sc">%&gt;%</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="st">`</span><span class="at">beta[0]==mu</span><span class="st">`</span><span class="sc">:</span>sigma, <span class="at">names_to =</span> <span class="st">"parameter"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">.width =</span> .<span class="dv">99</span>, <span class="at">normalize =</span> <span class="st">"panels"</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>               <span class="co"># customize some of the aesthetics</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="st">"lightskyblue1"</span>, <span class="at">color =</span> <span class="st">"royalblue"</span>, </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">point_color =</span> <span class="st">"darkorchid4"</span>, <span class="at">point_size =</span> <span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"fit0.b"</span>,</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"This time we used 99% intervals, and got silly with the colors."</span>,</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"parameter space"</span>) <span class="sc">+</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> parameter, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">labeller =</span> label_parsed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bayes_Lab_2_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>We might practice making a similar plot for our univariable model <code>fit1.b</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_draws_df</span>(fit1.b) <span class="sc">%&gt;%</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">beta[0]</span><span class="st">`</span> <span class="ot">=</span> b_Intercept,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">beta[1]</span><span class="st">`</span> <span class="ot">=</span> b_body_mass_g) <span class="sc">%&gt;%</span> </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">beta[0]</span><span class="st">`</span>, <span class="st">`</span><span class="at">beta[1]</span><span class="st">`</span>, sigma), </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"parameter"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_histinterval</span>(<span class="at">.width =</span> .<span class="dv">95</span>, <span class="at">normalize =</span> <span class="st">"panels"</span>) <span class="sc">+</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"fit1.b"</span>,</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Using good old 95% intervals, but switching to histograms"</span>,</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"parameter space"</span>) <span class="sc">+</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> parameter, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">labeller =</span> label_parsed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bayes_Lab_2_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Some authors, like John Kruschke, have a strong preference for plotting their posteriors with histograms, rather than density plots.</p>
</section>
</section>
<section id="distributions-of-the-model-expectations." class="level2">
<h2 class="anchored" data-anchor-id="distributions-of-the-model-expectations.">Distributions of the model expectations.</h2>
<p>Take another look at the <code>conditional_effects()</code> plot from earlier.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(fit1.b) <span class="sc">%&gt;%</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">points =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bayes_Lab_2_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>The blue line is the posterior mean, for the <span class="math inline">\(\mu_i\)</span>, the model-based mean for <code>bill_length_mm</code>, given the value for the predictor <code>body_mass_g</code>. The semitransparent gray ribbon marks the percentile-based interval for the conditional mean.</p>
<p>We can make a similar plot with the <code>fitted()</code> function. First we’ll need a predictor grid, we’ll call <code>nd</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">body_mass_g =</span> <span class="fu">seq</span>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">from =</span> <span class="fu">min</span>(chinstrap<span class="sc">$</span>body_mass_g),</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">to =</span> <span class="fu">max</span>(chinstrap<span class="sc">$</span>body_mass_g),</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">length.out =</span> <span class="dv">100</span>))</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(nd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 100
Columns: 1
$ body_mass_g &lt;dbl&gt; 2700.000, 2721.212, 2742.424, 2763.636, 2784.848, 2806.061…</code></pre>
</div>
</div>
<p>Now pump <code>nd</code> into the <code>fitted()</code> function.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(fit1.b, <span class="at">newdata =</span> nd) <span class="sc">%&gt;%</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># subset the first 6 rows</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     Estimate Est.Error     Q2.5    Q97.5
[1,] 44.23310 1.0079706 42.24422 46.24041
[2,] 44.32785 0.9896217 42.37700 46.29951
[3,] 44.42259 0.9713230 42.51467 46.35163
[4,] 44.51734 0.9530772 42.65479 46.40389
[5,] 44.61208 0.9348874 42.78800 46.45607
[6,] 44.70683 0.9167571 42.91905 46.52392</code></pre>
</div>
</div>
<p>Now plot.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(fit1.b, <span class="at">newdata =</span> nd) <span class="sc">%&gt;%</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(nd) <span class="sc">%&gt;%</span> </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g)) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate)) <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add the data</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> chinstrap,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> bill_length_mm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bayes_Lab_2_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Look what happens if we augment the <code>probs</code> argument in <code>fitted()</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(fit1.b, </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">newdata =</span> nd,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>, .<span class="dv">25</span>, .<span class="dv">75</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(nd) <span class="sc">%&gt;%</span> </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g)) <span class="sc">+</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 95% range</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 50% range</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Q25, <span class="at">ymax =</span> Q75),</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate)) <span class="sc">+</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> chinstrap,</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> bill_length_mm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bayes_Lab_2_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Now look what happens if we set <code>summary = FALSE</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(fit1.b, </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">newdata =</span> nd,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">summary =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> num [1:4000, 1:100] 43.9 43.2 41.7 45 43.4 ...</code></pre>
</div>
</div>
<p>We get full 4,000 draw posterior distributions for each of the 100 levels of the predictor <code>body_mass_g</code>. Now look at what happens if we wrangle that output a little, and plot with aid from <code>stat_lineribbon()</code> from the <strong>ggdist</strong> package.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(fit1.b, </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">newdata =</span> nd,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">summary =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">pull</span>(nd, body_mass_g)) <span class="sc">%&gt;%</span> </span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">draw =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>draw) <span class="sc">%&gt;%</span> </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">body_mass_g =</span> <span class="fu">as.double</span>(name)) <span class="sc">%&gt;%</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_lineribbon</span>() <span class="sc">+</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>() <span class="sc">+</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">range</span>(chinstrap<span class="sc">$</span>bill_length_mm)) <span class="sc">+</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bayes_Lab_2_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Look what happens when we request more intervals in the <code>.width</code> argument.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(fit1.b, </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">newdata =</span> nd,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">summary =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">pull</span>(nd, body_mass_g)) <span class="sc">%&gt;%</span> </span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">draw =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>draw) <span class="sc">%&gt;%</span> </span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">body_mass_g =</span> <span class="fu">as.double</span>(name)) <span class="sc">%&gt;%</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># make more ribbons</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_lineribbon</span>(<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">2</span>, .<span class="dv">3</span>, .<span class="dv">4</span>, .<span class="dv">5</span>, .<span class="dv">6</span>, .<span class="dv">7</span>, .<span class="dv">8</span>, .<span class="dv">9</span>),</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># remove the line</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">linewidth =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>() <span class="sc">+</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">range</span>(chinstrap<span class="sc">$</span>bill_length_mm)) <span class="sc">+</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bayes_Lab_2_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>The conditional mean, <span class="math inline">\(\mu_i\)</span>, has its own distribution. We can take this visualization approach even further to make a color gradient.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(fit1.b, </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">newdata =</span> nd,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">summary =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">pull</span>(nd, body_mass_g)) <span class="sc">%&gt;%</span> </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">draw =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>draw) <span class="sc">%&gt;%</span> </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">body_mass_g =</span> <span class="fu">as.double</span>(name)) <span class="sc">%&gt;%</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g, <span class="at">y =</span> value, <span class="at">fill =</span> <span class="fu">after_stat</span>(.width))) <span class="sc">+</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># make more ribbons</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_lineribbon</span>(<span class="at">.width =</span> <span class="fu">ppoints</span>(<span class="dv">50</span>)) <span class="sc">+</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">limits =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">range</span>(chinstrap<span class="sc">$</span>bill_length_mm)) <span class="sc">+</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bayes_Lab_2_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>For technical details on this visualization approach, go here: <a href="https://mjskay.github.io/ggdist/articles/lineribbon.html#lineribbon-gradients" class="uri">https://mjskay.github.io/ggdist/articles/lineribbon.html#lineribbon-gradients</a>.</p>
<p>The <strong>ggdist</strong> package even has an experimental visualization approach that’s based on density gradients, rather than interval-width gradients. Since this is experimental, I’m not going to go into the details. But if you’re curious and adventurous, you can learn more here: <a href="https://mjskay.github.io/ggdist/articles/lineribbon.html#lineribbon-density-gradients" class="uri">https://mjskay.github.io/ggdist/articles/lineribbon.html#lineribbon-density-gradients</a>.</p>
<section id="posterior-predictive-distributions." class="level3">
<h3 class="anchored" data-anchor-id="posterior-predictive-distributions.">Posterior-predictive distributions.</h3>
<p>The last section showed the posterior distributions for the model expectations (i.e., the conditional means). In the context of the Gaussian distribution, that’s <span class="math inline">\(\mu\)</span>, or <span class="math inline">\(\mu_i\)</span> in the case of the univariable model <code>fit1.b</code>. But the whole Gaussian distribution includes <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>.</p>
<p>This is where the <code>predict()</code> function comes in. First, we compare the <code>fitted()</code> output to <code>predict()</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(fit1.b, <span class="at">newdata =</span> nd) <span class="sc">%&gt;%</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># subset the first 6 rows</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     Estimate Est.Error     Q2.5    Q97.5
[1,] 44.23310 1.0079706 42.24422 46.24041
[2,] 44.32785 0.9896217 42.37700 46.29951
[3,] 44.42259 0.9713230 42.51467 46.35163
[4,] 44.51734 0.9530772 42.65479 46.40389
[5,] 44.61208 0.9348874 42.78800 46.45607
[6,] 44.70683 0.9167571 42.91905 46.52392</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit1.b, <span class="at">newdata =</span> nd) <span class="sc">%&gt;%</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># subset the first 6 rows</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     Estimate Est.Error     Q2.5    Q97.5
[1,] 44.27184  3.112532 38.11578 50.25957
[2,] 44.37165  3.125233 38.12058 50.44919
[3,] 44.41703  3.094976 38.50962 50.57118
[4,] 44.49376  3.081426 38.36049 50.49796
[5,] 44.63676  3.090296 38.46251 50.76884
[6,] 44.75065  3.075866 38.61483 50.84024</code></pre>
</div>
</div>
<p>The posterior means (<code>Estimate</code>) are about the same, but the SD’s (<code>Est.Error</code>) are much larger in the <code>predict()</code> output, and the widths of the 95% intervals are too. Let’s make a plot.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit1.b, <span class="at">newdata =</span> nd) <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(nd) <span class="sc">%&gt;%</span> </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g)) <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate)) <span class="sc">+</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add the data</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> chinstrap,</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> bill_length_mm)) <span class="sc">+</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">range</span>(chinstrap<span class="sc">$</span>bill_length_mm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bayes_Lab_2_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>The gray band is the 95% interval for the entire posterior predictive distribution, not just the mean. In a good model, about 95% of the data points should be within those bands.</p>
<p>Discuss how the jagged lines have to do with the uncertainty in <span class="math inline">\(\sigma\)</span>.</p>
<p>If we wanted to, we could integrate the <code>fitted()</code>-based conditional posterior mean, with the <code>predict()</code>-based posterior-predictive distribution.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save the fitted() results</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">fitted</span>(fit1.b, <span class="at">newdata =</span> nd) <span class="sc">%&gt;%</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(nd) </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit1.b, <span class="at">newdata =</span> nd) <span class="sc">%&gt;%</span> </span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(nd) <span class="sc">%&gt;%</span> </span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g)) <span class="sc">+</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 95% posterior-predictive range</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 95% conditional mean range</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> f,</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># posterior mean of the conditional mean</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> f,</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> Estimate)) <span class="sc">+</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># original data</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> chinstrap,</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> bill_length_mm)) <span class="sc">+</span></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">range</span>(chinstrap<span class="sc">$</span>bill_length_mm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bayes_Lab_2_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>It’s the posterior predictive distribution that we use to predict new data points. For example, here’s what happens if we use <code>predict()</code> without the <code>newdata</code> argument.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit1.b) <span class="sc">%&gt;%</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     Estimate Est.Error     Q2.5    Q97.5
[1,] 47.75351  3.002885 42.05586 53.62070
[2,] 49.53782  2.937910 43.79139 55.28441
[3,] 48.38029  3.001341 42.38645 54.22588
[4,] 47.91471  3.004663 41.96078 53.87637
[5,] 48.79252  3.005188 42.87218 54.53226
[6,] 49.66407  2.943077 43.78867 55.29868</code></pre>
</div>
</div>
<p>We get posterior predictive summaries for each of the original data points. Here’s what happens if we set <code>summary = FALSE</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit1.b, <span class="at">summary =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> num [1:4000, 1:68] 41.3 42.1 49.1 46.6 43.8 ...
 - attr(*, "dimnames")=List of 2
  ..$ : NULL
  ..$ : NULL</code></pre>
</div>
</div>
<p>This time, we got 4,000 posterior draws for each. We can reduce that output with the <code>ndraws</code> argument.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit1.b, <span class="at">summary =</span> <span class="cn">FALSE</span>, <span class="at">ndraws =</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> num [1:6, 1:68] 48.6 48 46.1 41.5 47.5 ...
 - attr(*, "dimnames")=List of 2
  ..$ : NULL
  ..$ : NULL</code></pre>
</div>
</div>
<p>Now wrangle and plot.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit1.b, <span class="at">summary =</span> <span class="cn">FALSE</span>, <span class="at">ndraws =</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">draw =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>draw) <span class="sc">%&gt;%</span> </span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">str_remove</span>(name, <span class="st">"X"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.double</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(chinstrap <span class="sc">%&gt;%</span> </span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">row =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()),</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">join_by</span>(row)) <span class="sc">%&gt;%</span> </span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g, <span class="at">y =</span> value)) <span class="sc">+</span> </span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"bill_length_mm"</span>) <span class="sc">+</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> draw, <span class="at">labeller =</span> label_both)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bayes_Lab_2_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>With <code>predict()</code>, we can use the entire posterior-predictive distribution to simulate new data based on the values of our predictor variable(s). To give you a better sense of what’s happening under the hood, here’s an <code>as_draws_df()</code> based alternative.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co"># walk this code through</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="fu">as_draws_df</span>(fit1.b) <span class="sc">%&gt;%</span> </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">beta0 =</span> b_Intercept,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">beta1 =</span> b_body_mass_g) <span class="sc">%&gt;%</span> </span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.draw, beta0, beta1, sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(chinstrap <span class="sc">%&gt;%</span> <span class="fu">select</span>(body_mass_g)) <span class="sc">%&gt;%</span> </span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bill_length_mm =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>                                <span class="at">mean =</span> beta0 <span class="sc">+</span> beta1 <span class="sc">*</span> body_mass_g,</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>                                <span class="at">sd =</span> sigma)) <span class="sc">%&gt;%</span> </span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g, <span class="at">y =</span> bill_length_mm)) <span class="sc">+</span> </span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> .draw, <span class="at">labeller =</span> label_both)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bayes_Lab_2_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Now take a look at what happens when we plot the densities of several simulated draws.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">as_draws_df</span>(fit1.b) <span class="sc">%&gt;%</span> </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">beta0 =</span> b_Intercept,</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">beta1 =</span> b_body_mass_g) <span class="sc">%&gt;%</span> </span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.draw, beta0, beta1, sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">50</span>) <span class="sc">%&gt;%</span>  <span class="co"># increase the number of random draws</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(chinstrap <span class="sc">%&gt;%</span> <span class="fu">select</span>(body_mass_g)) <span class="sc">%&gt;%</span> </span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bill_length_mm =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>                                <span class="at">mean =</span> beta0 <span class="sc">+</span> beta1 <span class="sc">*</span> body_mass_g,</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>                                <span class="at">sd =</span> sigma)) <span class="sc">%&gt;%</span> </span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm, <span class="at">group =</span> .draw)) <span class="sc">+</span> </span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">color =</span> <span class="fu">alpha</span>(<span class="st">"black"</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">range</span>(chinstrap<span class="sc">$</span>bill_length_mm) <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bayes_Lab_2_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>The similarities and differences among the individual density lines give you a sense of the (un)certainty of the posterior-predictive distribution.</p>
<p><strong>This may be a good time for you to work on Exercise 1 (see end of the document)</strong></p>
<p>#Part 4: Beginning to look at priors</p>
</section>
</section>
<section id="bayes-rule" class="level2">
<h2 class="anchored" data-anchor-id="bayes-rule">Bayes’ rule</h2>
<p>Bayes’ theorem will allow us to determine the plausibility of various values of our parameter(s) of interest, <span class="math inline">\(\theta\)</span>, given the data <span class="math inline">\(d\)</span>, which we can express formally as <span class="math inline">\(\Pr(\theta \mid d)\)</span>. Bayes’ rule takes on the form</p>
<p><span class="math display">\[
\Pr(\theta \mid d) = \frac{\Pr(d \mid \theta) \Pr(\theta)}{\Pr(d)}.
\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(\Pr(d \mid \theta)\)</span> is the <em>likelihood</em>,</li>
<li><span class="math inline">\(\Pr(\theta)\)</span> is the <em>prior</em>,</li>
<li><span class="math inline">\(\Pr(d)\)</span> is the <em>average probability of the data</em>, and</li>
<li><span class="math inline">\(\Pr(\theta \mid d)\)</span> is the <em>posterior</em>.</li>
</ul>
<p>We can express this in words as</p>
<p><span class="math display">\[
\text{Posterior} = \frac{\text{Probability of the data} \times \text{Prior}}{\text{Average probability of the data}}.
\]</span></p>
<p>The denominator <span class="math inline">\(\Pr(d)\)</span> is a normalizing constant, and dividing by this constant is what converts the posterior <span class="math inline">\(\Pr(\theta \mid d)\)</span> into a probability metric.</p>
</section>
<section id="default-priors" class="level2">
<h2 class="anchored" data-anchor-id="default-priors">Default priors</h2>
<p>To set your priors with <strong>brms</strong>, the <code>brm()</code> function has a <code>prior</code> argument. If you don’t explicitly use the <code>prior</code> argument, <code>brm()</code> will use default priors. This is what happened with our <code>fit1.b</code> model from above. We used default priors. If you’d like to see what those priors are, execute <code>fit1.b$prior</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># maybe show str(fit1.b)</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>fit1.b<span class="sc">$</span>prior</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   prior     class        coef group resp dpar nlpar lb ub
                  (flat)         b                                        
                  (flat)         b body_mass_g                            
 student_t(3, 49.5, 3.6) Intercept                                        
    student_t(3, 0, 3.6)     sigma                                    0   
       source
      default
 (vectorized)
      default
      default</code></pre>
</div>
</div>
<p>Thus, a fuller expression of our model is</p>
<p><span class="math display">\[
\begin{aligned}
\text{bill\_length\_mm}_i &amp; \sim \operatorname{Normal}(\mu_i, \sigma) \\
\mu_i &amp; = \beta_0 + \beta_1 \text{body\_mass\_g}_i \\
\beta_0 &amp; \sim \operatorname{Student-t}(3, 49.5, 3.6) \\
\beta_1 &amp; \sim \operatorname{Uniform}(-\infty, \infty) \\
\sigma &amp; \sim \operatorname{Student-t}^+(3, 0, 3.6).
\end{aligned}
\]</span></p>
<p>If we had wanted to see the <code>brm()</code> defaults before fitting the model, we could have used the <code>get_prior()</code> function.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_prior</span>(</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> chinstrap,</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  bill_length_mm <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> body_mass_g</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   prior     class        coef group resp dpar nlpar lb ub
                  (flat)         b                                        
                  (flat)         b body_mass_g                            
 student_t(3, 49.5, 3.6) Intercept                                        
    student_t(3, 0, 3.6)     sigma                                    0   
       source
      default
 (vectorized)
      default
      default</code></pre>
</div>
</div>
<p>If you recall, the normal distribution is a member of the Student-t family, where the <span class="math inline">\(\nu\)</span> (aka degrees of freedom or normality parameter) is set to <span class="math inline">\(\infty\)</span>. To give you a sense, here are the densities of three members of the Student-t family, with varying <span class="math inline">\(\nu\)</span> values.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">crossing</span>(<span class="at">theta =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="fl">4.5</span>, <span class="at">to =</span> <span class="fl">4.5</span>, <span class="at">length.out =</span> <span class="dv">200</span>),</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">nu =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">10</span>, <span class="cn">Inf</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density =</span> <span class="fu">dt</span>(<span class="at">x =</span> theta, <span class="at">df =</span> nu)) <span class="sc">%&gt;%</span> </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> theta, <span class="at">y =</span> density, <span class="at">color =</span> <span class="fu">factor</span>(nu))) <span class="sc">+</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="fu">expression</span>(nu), <span class="at">option =</span> <span class="st">"A"</span>, <span class="at">end =</span> .<span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"3 members of the Student-t family"</span>,</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">expression</span>(theta)) <span class="sc">+</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bayes_Lab_2_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Thus, Student-t distributions have thicker tails when they have smaller <span class="math inline">\(\nu\)</span> parameters. In the case where <span class="math inline">\(\nu = 3\)</span>, the tails are pretty thick, which means they are more tolerant of more extreme values. And thus priors with small-<span class="math inline">\(\nu\)</span> parameters will be weaker (i.e., more permissive) than their Gaussian counterparts.</p>
<p>We can visualize functions from <strong>ggdist</strong> to visualize the default <code>brm()</code> priors. We’ll start with the <code>student_t(3, 49.5, 3.6)</code> <span class="math inline">\(\beta_0\)</span> prior, and also take the opportunity to compare that with a slightly stronger <code>normal(49.5, 3.6)</code> alternative.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="fl">49.5</span>, <span class="fl">3.6</span>)),</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fl">49.5</span>, <span class="fl">3.6</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parse_dist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">xdist =</span> .dist_obj, <span class="at">y =</span> prior)) <span class="sc">+</span> </span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>() <span class="sc">+</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">italic</span>(p)(beta[<span class="dv">0</span>])),</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">75</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bayes_Lab_2_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>See how that <span class="math inline">\(n = 3\)</span> parameter in the default prior let do much thicker tails than it’s Gaussian counterpart. We can make the same kind of plot for our default <span class="math inline">\(\sigma\)</span> prior and its half-Gaussian counterpart.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="fl">3.6</span>), <span class="at">lb =</span> <span class="dv">0</span>),  <span class="co"># note our use of the lb = 0 argument</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">3.6</span>), <span class="at">lb =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parse_dist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">xdist =</span> .dist_obj, <span class="at">y =</span> prior)) <span class="sc">+</span> </span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">point_interval =</span> mean_qi, <span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">90</span>, .<span class="dv">99</span>)) <span class="sc">+</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">italic</span>(p)(sigma)),</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bayes_Lab_2_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Here’s how we could have explicitly set our priors by hand.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>fit2.b <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> chinstrap,</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  bill_length_mm <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> body_mass_g,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="fl">49.5</span>, <span class="fl">3.6</span>), <span class="at">class =</span> Intercept) <span class="sc">+</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="fl">3.6</span>), <span class="at">class =</span> sigma, <span class="at">lb =</span> <span class="dv">0</span>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Compare the results.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1.b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: bill_length_mm ~ 1 + body_mass_g 
   Data: chinstrap (Number of observations: 68) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Regression Coefficients:
            Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept      32.17      3.46    25.37    38.99 1.00     4643     3271
body_mass_g     0.00      0.00     0.00     0.01 1.00     4628     3211

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     2.93      0.26     2.48     3.50 1.00     1956     1927

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2.b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: bill_length_mm ~ 1 + body_mass_g 
   Data: chinstrap (Number of observations: 68) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Regression Coefficients:
            Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept      32.23      3.58    25.44    39.20 1.00     5050     2927
body_mass_g     0.00      0.00     0.00     0.01 1.00     5054     2899

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     2.92      0.25     2.47     3.45 1.00     2345     2100

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section id="question-2-are-the-priors-the-same-what-do-you-think-is-going-on" class="level2">
<h2 class="anchored" data-anchor-id="question-2-are-the-priors-the-same-what-do-you-think-is-going-on">QUESTION 2 Are the priors the same? What do you think is going on?</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>fit1.b<span class="sc">$</span>prior</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   prior     class        coef group resp dpar nlpar lb ub
                  (flat)         b                                        
                  (flat)         b body_mass_g                            
 student_t(3, 49.5, 3.6) Intercept                                        
    student_t(3, 0, 3.6)     sigma                                    0   
       source
      default
 (vectorized)
      default
      default</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>fit2.b<span class="sc">$</span>prior</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   prior     class        coef group resp dpar nlpar lb ub
                  (flat)         b                                        
                  (flat)         b body_mass_g                            
 student_t(3, 49.5, 3.6) Intercept                                        
    student_t(3, 0, 3.6)     sigma                                    0   
       source
      default
 (vectorized)
         user
         user</code></pre>
</div>
</div>
<section id="answer-1" class="level3">
<h3 class="anchored" data-anchor-id="answer-1">Answer:</h3>
<p>The priors seem to be the same between these two models. For model 1, all three priors are by default. For model 2, we are specifying the priors for the intercept and for sigma, while we are still using the default prior for the slope.</p>
<p>If you want to learn more about the default prior settings for <strong>brms</strong>, read through the <code>set_prior</code> section of the <strong>brms</strong> reference manual (https://CRAN.R-project.org/package=brms/brms.pdf).</p>
</section>
</section>
</section>
<section id="exercise-1" class="level1">
<h1>EXERCISE 1</h1>
<p>In the previous lab, we made a subset of the <code>penguins</code> data called <code>gentoo</code>, which was only the cases for which <code>species == "Gentoo"</code>. Do that again and refit the Bayesian model to those data. Remake some of the figures (From Part 3) in this file with the new version of the model?</p>
<section id="answer-your-solution-below" class="level3">
<h3 class="anchored" data-anchor-id="answer-your-solution-below">Answer/ Your solution below:</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># subset the data</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>gentoo <span class="ot">=</span> penguins <span class="sc">%&gt;%</span> </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Gentoo"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(bill_length_mm, body_mass_g)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Bayes</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>fit3.b <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> gentoo,</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  bill_length_mm <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> body_mass_g</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Posterior Means</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>b0    <span class="ot">=</span> <span class="fu">posterior_summary</span>(fit3.b)[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>b1    <span class="ot">=</span> <span class="fu">posterior_summary</span>(fit3.b)[<span class="dv">2</span>, <span class="dv">1</span>]</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">=</span> <span class="fu">posterior_summary</span>(fit3.b)[<span class="dv">3</span>, <span class="dv">1</span>]</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="fu">crossing</span>(<span class="at">body_mass_g    =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">3800</span>, <span class="at">to =</span> <span class="dv">6400</span>, <span class="at">length.out =</span> <span class="dv">200</span>),</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">bill_length_mm =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">40</span>, <span class="at">to =</span> <span class="dv">60</span>, <span class="at">length.out =</span> <span class="dv">200</span>))  <span class="sc">%&gt;%</span> </span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density =</span> <span class="fu">dnorm</span>(<span class="at">x =</span> bill_length_mm, </span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">mean =</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> body_mass_g,</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sd =</span> sigma)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g, <span class="at">y =</span> bill_length_mm)) <span class="sc">+</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">fill =</span> density),</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">interpolate =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> gentoo,</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">fill =</span> <span class="st">"black"</span>, <span class="at">stroke =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"A"</span>, <span class="at">begin =</span> .<span class="dv">15</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">range</span>(gentoo<span class="sc">$</span>body_mass_g),</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">range</span>(gentoo<span class="sc">$</span>bill_length_mm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bayes_Lab_2_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameter Distributions</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as_draws_df</span>(fit3.b) <span class="sc">%&gt;%</span> </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">beta[0]</span><span class="st">`</span> <span class="ot">=</span> b_Intercept,</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">beta[1]</span><span class="st">`</span> <span class="ot">=</span> b_body_mass_g) <span class="sc">%&gt;%</span> </span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">beta[0]</span><span class="st">`</span>, <span class="st">`</span><span class="at">beta[1]</span><span class="st">`</span>, sigma), </span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"parameter"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_histinterval</span>(<span class="at">.width =</span> .<span class="dv">95</span>, <span class="at">normalize =</span> <span class="st">"panels"</span>) <span class="sc">+</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"fit1.b"</span>,</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Using good old 95% intervals, but switching to histograms"</span>,</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"parameter space"</span>) <span class="sc">+</span></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> parameter, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">labeller =</span> label_parsed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bayes_Lab_2_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model Expectations</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">body_mass_g =</span> <span class="fu">seq</span>(</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">from =</span> <span class="fu">min</span>(gentoo<span class="sc">$</span>body_mass_g),</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">to =</span> <span class="fu">max</span>(gentoo<span class="sc">$</span>body_mass_g),</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">length.out =</span> <span class="dv">100</span>))</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(fit3.b, <span class="at">newdata =</span> nd) <span class="sc">%&gt;%</span> </span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(nd) <span class="sc">%&gt;%</span> </span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g)) <span class="sc">+</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate)) <span class="sc">+</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add the data</span></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> gentoo,</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> bill_length_mm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bayes_Lab_2_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(fit3.b, </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">newdata =</span> nd,</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">summary =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">pull</span>(nd, body_mass_g)) <span class="sc">%&gt;%</span> </span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">draw =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>draw) <span class="sc">%&gt;%</span> </span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">body_mass_g =</span> <span class="fu">as.double</span>(name)) <span class="sc">%&gt;%</span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># make more ribbons</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_lineribbon</span>(<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">2</span>, .<span class="dv">3</span>, .<span class="dv">4</span>, .<span class="dv">5</span>, .<span class="dv">6</span>, .<span class="dv">7</span>, .<span class="dv">8</span>, .<span class="dv">9</span>),</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># remove the line</span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">linewidth =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>() <span class="sc">+</span></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">range</span>(gentoo<span class="sc">$</span>bill_length_mm)) <span class="sc">+</span></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bayes_Lab_2_files/figure-html/unnamed-chunk-40-2.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Posterior-predictive Distributions</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">fitted</span>(fit3.b, <span class="at">newdata =</span> nd) <span class="sc">%&gt;%</span> </span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(nd) </span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit3.b, <span class="at">newdata =</span> nd) <span class="sc">%&gt;%</span> </span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(nd) <span class="sc">%&gt;%</span> </span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g)) <span class="sc">+</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 95% posterior-predictive range</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 95% conditional mean range</span></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> f,</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># posterior mean of the conditional mean</span></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> f,</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> Estimate)) <span class="sc">+</span></span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># original data</span></span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> gentoo,</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> bill_length_mm)) <span class="sc">+</span></span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">range</span>(gentoo<span class="sc">$</span>bill_length_mm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bayes_Lab_2_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit3.b, <span class="at">summary =</span> <span class="cn">FALSE</span>, <span class="at">ndraws =</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">draw =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>draw) <span class="sc">%&gt;%</span> </span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">str_remove</span>(name, <span class="st">"X"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.double</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(gentoo <span class="sc">%&gt;%</span> </span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">row =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()),</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">join_by</span>(row)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g, <span class="at">y =</span> value)) <span class="sc">+</span> </span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"bill_length_mm"</span>) <span class="sc">+</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> draw, <span class="at">labeller =</span> label_both)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bayes_Lab_2_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">as_draws_df</span>(fit3.b) <span class="sc">%&gt;%</span> </span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">beta0 =</span> b_Intercept,</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">beta1 =</span> b_body_mass_g) <span class="sc">%&gt;%</span> </span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.draw, beta0, beta1, sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">50</span>) <span class="sc">%&gt;%</span>  <span class="co"># increase the number of random draws</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(gentoo <span class="sc">%&gt;%</span> <span class="fu">select</span>(body_mass_g)) <span class="sc">%&gt;%</span> </span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bill_length_mm =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>                                <span class="at">mean =</span> beta0 <span class="sc">+</span> beta1 <span class="sc">*</span> body_mass_g,</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>                                <span class="at">sd =</span> sigma)) <span class="sc">%&gt;%</span> </span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm, <span class="at">group =</span> .draw)) <span class="sc">+</span> </span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">color =</span> <span class="fu">alpha</span>(<span class="st">"black"</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">range</span>(gentoo<span class="sc">$</span>bill_length_mm) <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bayes_Lab_2_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prior parameter distribution</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>fit3.b<span class="sc">$</span>prior</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   prior     class        coef group resp dpar nlpar lb ub
                  (flat)         b                                        
                  (flat)         b body_mass_g                            
 student_t(3, 47.3, 3.1) Intercept                                        
    student_t(3, 0, 3.1)     sigma                                    0   
       source
      default
 (vectorized)
      default
      default</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="fl">47.3</span>, <span class="fl">3.1</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parse_dist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">xdist =</span> .dist_obj, <span class="at">y =</span> prior)) <span class="sc">+</span> </span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>() <span class="sc">+</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">italic</span>(p)(beta[<span class="dv">0</span>])),</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">75</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bayes_Lab_2_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="fl">3.1</span>), <span class="at">lb =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parse_dist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">xdist =</span> .dist_obj, <span class="at">y =</span> prior)) <span class="sc">+</span> </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">point_interval =</span> mean_qi, <span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">90</span>, .<span class="dv">99</span>)) <span class="sc">+</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">italic</span>(p)(sigma)),</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bayes_Lab_2_files/figure-html/unnamed-chunk-44-2.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<p>Kruschke, J. K. (2015). <em>Doing Bayesian data analysis: A tutorial with R, JAGS, and Stan</em>. Academic Press. <a href="https://sites.google.com/site/doingbayesiandataanalysis/" class="uri">https://sites.google.com/site/doingbayesiandataanalysis/</a></p>
</section>
<section id="session-information" class="level2">
<h2 class="anchored" data-anchor-id="session-information">Session information</h2>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb75" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Lab: Bayes_Lab_2"</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Princeton University"</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2025-04-09"</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "KW"</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [code, analysis]</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a><span class="co">    self-contained: false</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="co">    anchor-sections: true</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-width: 8</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-height: 4</span></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a><span class="co">    code-block-bg: "#f1f3f5"</span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a><span class="co">    code-block-border-left: "#31BAE9"</span></span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a><span class="co">    mainfont: Source Sans Pro</span></span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: journal</span></span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: left</span></span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a><span class="co">    captions: true</span></span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a><span class="co">    cap-location: margin</span></span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a><span class="co">    table-captions: true</span></span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a><span class="co">    tbl-cap-location: margin</span></span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a><span class="co">    reference-location: margin</span></span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a><span class="co">  pdf:</span></span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a><span class="co">    pdf-engine: lualatex</span></span>
<span id="cb75-29"><a href="#cb75-29" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: false</span></span>
<span id="cb75-30"><a href="#cb75-30" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb75-31"><a href="#cb75-31" aria-hidden="true" tabindex="-1"></a><span class="co">    number-depth: 2</span></span>
<span id="cb75-32"><a href="#cb75-32" aria-hidden="true" tabindex="-1"></a><span class="co">    top-level-division: section</span></span>
<span id="cb75-33"><a href="#cb75-33" aria-hidden="true" tabindex="-1"></a><span class="co">    reference-location: document</span></span>
<span id="cb75-34"><a href="#cb75-34" aria-hidden="true" tabindex="-1"></a><span class="co">    listings: false</span></span>
<span id="cb75-35"><a href="#cb75-35" aria-hidden="true" tabindex="-1"></a><span class="co">    header-includes:</span></span>
<span id="cb75-36"><a href="#cb75-36" aria-hidden="true" tabindex="-1"></a><span class="co">      \usepackage{marginnote, here, relsize, needspace, setspace}</span></span>
<span id="cb75-37"><a href="#cb75-37" aria-hidden="true" tabindex="-1"></a><span class="co">      \def\it{\emph}</span></span>
<span id="cb75-38"><a href="#cb75-38" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb75-39"><a href="#cb75-39" aria-hidden="true" tabindex="-1"></a><span class="co">  freeze: auto</span></span>
<span id="cb75-40"><a href="#cb75-40" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb75-41"><a href="#cb75-41" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb75-42"><a href="#cb75-42" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb75-43"><a href="#cb75-43" aria-hidden="true" tabindex="-1"></a><span class="co">  fig-align: center</span></span>
<span id="cb75-44"><a href="#cb75-44" aria-hidden="true" tabindex="-1"></a><span class="co">  fig-width: 12</span></span>
<span id="cb75-45"><a href="#cb75-45" aria-hidden="true" tabindex="-1"></a><span class="co">  fig-height: 8</span></span>
<span id="cb75-46"><a href="#cb75-46" aria-hidden="true" tabindex="-1"></a><span class="co">  editor_options: </span></span>
<span id="cb75-47"><a href="#cb75-47" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: inline</span></span>
<span id="cb75-48"><a href="#cb75-48" aria-hidden="true" tabindex="-1"></a><span class="co">  code-overflow: wrap</span></span>
<span id="cb75-49"><a href="#cb75-49" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb75-50"><a href="#cb75-50" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb75-51"><a href="#cb75-51" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb75-52"><a href="#cb75-52" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb75-53"><a href="#cb75-53" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb75-54"><a href="#cb75-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-55"><a href="#cb75-55" aria-hidden="true" tabindex="-1"></a>For Lab 1, you had explored the data and looked at models built via lm() and via brms(using default priors). You had also drawn posterior samples after fitting the model.</span>
<span id="cb75-56"><a href="#cb75-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-57"><a href="#cb75-57" aria-hidden="true" tabindex="-1"></a>For Lab 2, we continue with the Palmer Penguins. And we will look more at distributions and priors.</span>
<span id="cb75-58"><a href="#cb75-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-59"><a href="#cb75-59" aria-hidden="true" tabindex="-1"></a>Again, there will be conceptual questions to answer as you work through this example, and exercises.</span>
<span id="cb75-60"><a href="#cb75-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-61"><a href="#cb75-61" aria-hidden="true" tabindex="-1"></a><span class="fu"># Part 3: Distributions all the way down</span></span>
<span id="cb75-62"><a href="#cb75-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-63"><a href="#cb75-63" aria-hidden="true" tabindex="-1"></a>Given it's a continuation of Lab 1, let's begin by loading relevant packages, cleaning/pre-processing the data, and fitting lm() and the default brm models</span>
<span id="cb75-64"><a href="#cb75-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-65"><a href="#cb75-65" aria-hidden="true" tabindex="-1"></a><span class="fu">## Setup: Packages and data</span></span>
<span id="cb75-66"><a href="#cb75-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-67"><a href="#cb75-67" aria-hidden="true" tabindex="-1"></a>We load the primary packages.</span>
<span id="cb75-68"><a href="#cb75-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-69"><a href="#cb75-69" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = FALSE, message = FALSE}</span></span>
<span id="cb75-70"><a href="#cb75-70" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse)</span></span>
<span id="cb75-71"><a href="#cb75-71" aria-hidden="true" tabindex="-1"></a><span class="in">library(brms)</span></span>
<span id="cb75-72"><a href="#cb75-72" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidybayes)</span></span>
<span id="cb75-73"><a href="#cb75-73" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggdist)</span></span>
<span id="cb75-74"><a href="#cb75-74" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-75"><a href="#cb75-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-76"><a href="#cb75-76" aria-hidden="true" tabindex="-1"></a>We want the same data set up as in the last lab.</span>
<span id="cb75-77"><a href="#cb75-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-80"><a href="#cb75-80" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-81"><a href="#cb75-81" aria-hidden="true" tabindex="-1"></a><span class="co"># load the penguins data</span></span>
<span id="cb75-82"><a href="#cb75-82" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(penguins, <span class="at">package =</span> <span class="st">"palmerpenguins"</span>)</span>
<span id="cb75-83"><a href="#cb75-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-84"><a href="#cb75-84" aria-hidden="true" tabindex="-1"></a><span class="co"># subset the data</span></span>
<span id="cb75-85"><a href="#cb75-85" aria-hidden="true" tabindex="-1"></a>chinstrap <span class="ot">&lt;-</span> penguins <span class="sc">%&gt;%</span> </span>
<span id="cb75-86"><a href="#cb75-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Chinstrap"</span>)</span>
<span id="cb75-87"><a href="#cb75-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-88"><a href="#cb75-88" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(chinstrap)</span>
<span id="cb75-89"><a href="#cb75-89" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-90"><a href="#cb75-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-91"><a href="#cb75-91" aria-hidden="true" tabindex="-1"></a><span class="fu">## Models</span></span>
<span id="cb75-92"><a href="#cb75-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-93"><a href="#cb75-93" aria-hidden="true" tabindex="-1"></a>Once again, we'll fit the model</span>
<span id="cb75-94"><a href="#cb75-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-95"><a href="#cb75-95" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-96"><a href="#cb75-96" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb75-97"><a href="#cb75-97" aria-hidden="true" tabindex="-1"></a>\text{bill<span class="sc">\_</span>length<span class="sc">\_</span>mm}_i &amp; = \beta_0 + \beta_1 \text{body<span class="sc">\_</span>mass<span class="sc">\_</span>g}_i + \epsilon_i <span class="sc">\\</span></span>
<span id="cb75-98"><a href="#cb75-98" aria-hidden="true" tabindex="-1"></a>\epsilon_i &amp; \sim \operatorname{Normal}(0, \sigma_\epsilon) ,</span>
<span id="cb75-99"><a href="#cb75-99" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb75-100"><a href="#cb75-100" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-101"><a href="#cb75-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-102"><a href="#cb75-102" aria-hidden="true" tabindex="-1"></a>with both <span class="in">`lm()`</span> and <span class="in">`brm()`</span>.</span>
<span id="cb75-103"><a href="#cb75-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-104"><a href="#cb75-104" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fit_again, results = "hide"}</span></span>
<span id="cb75-105"><a href="#cb75-105" aria-hidden="true" tabindex="-1"></a><span class="in"># OLS</span></span>
<span id="cb75-106"><a href="#cb75-106" aria-hidden="true" tabindex="-1"></a><span class="in">fit1.ols &lt;- lm(</span></span>
<span id="cb75-107"><a href="#cb75-107" aria-hidden="true" tabindex="-1"></a><span class="in">  data = chinstrap,</span></span>
<span id="cb75-108"><a href="#cb75-108" aria-hidden="true" tabindex="-1"></a><span class="in">  bill_length_mm ~ 1 + body_mass_g</span></span>
<span id="cb75-109"><a href="#cb75-109" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb75-110"><a href="#cb75-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-111"><a href="#cb75-111" aria-hidden="true" tabindex="-1"></a><span class="in"># Bayes</span></span>
<span id="cb75-112"><a href="#cb75-112" aria-hidden="true" tabindex="-1"></a><span class="in">fit1.b &lt;- brm(</span></span>
<span id="cb75-113"><a href="#cb75-113" aria-hidden="true" tabindex="-1"></a><span class="in">  data = chinstrap,</span></span>
<span id="cb75-114"><a href="#cb75-114" aria-hidden="true" tabindex="-1"></a><span class="in">  bill_length_mm ~ 1 + body_mass_g</span></span>
<span id="cb75-115"><a href="#cb75-115" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb75-116"><a href="#cb75-116" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-117"><a href="#cb75-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-118"><a href="#cb75-118" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bayesians have many kinds of distributions</span></span>
<span id="cb75-119"><a href="#cb75-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-120"><a href="#cb75-120" aria-hidden="true" tabindex="-1"></a>In Bayesian statistics, we have at least 6 distributions to keep track of. Those are:</span>
<span id="cb75-121"><a href="#cb75-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-122"><a href="#cb75-122" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>the likelihood distributions</span>
<span id="cb75-123"><a href="#cb75-123" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>the prior parameter distribution (aka priors)</span>
<span id="cb75-124"><a href="#cb75-124" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>the prior predictive distributions</span>
<span id="cb75-125"><a href="#cb75-125" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>the posterior parameter distributions (aka posteriors)</span>
<span id="cb75-126"><a href="#cb75-126" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>the posterior-predictive distribution</span>
<span id="cb75-127"><a href="#cb75-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-128"><a href="#cb75-128" aria-hidden="true" tabindex="-1"></a>In many respect, it's distributions 'all the way down,' with Bayesians. This can be indeed be difficult to keep track of at first. But since this is true for any class of Bayesian models (not just regression), you'll hopefully get used to it.\</span>
<span id="cb75-129"><a href="#cb75-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-130"><a href="#cb75-130" aria-hidden="true" tabindex="-1"></a><span class="fu">### QUESTION 1: How would you represent these 6 distributions mathematically, using $P_0$'$P$, $D$, $|$, and $\theta$ ?</span></span>
<span id="cb75-131"><a href="#cb75-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-132"><a href="#cb75-132" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb75-133"><a href="#cb75-133" aria-hidden="true" tabindex="-1"></a>Hint 1: Many of these terms were in the Bayes Rule.</span>
<span id="cb75-134"><a href="#cb75-134" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb75-135"><a href="#cb75-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-136"><a href="#cb75-136" aria-hidden="true" tabindex="-1"></a><span class="fu">### Answer:</span></span>
<span id="cb75-137"><a href="#cb75-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-138"><a href="#cb75-138" aria-hidden="true" tabindex="-1"></a>Likelihood: $P(D|\theta)$</span>
<span id="cb75-139"><a href="#cb75-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-140"><a href="#cb75-140" aria-hidden="true" tabindex="-1"></a>Prior parameter distribution: $P_0(\theta)$</span>
<span id="cb75-141"><a href="#cb75-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-142"><a href="#cb75-142" aria-hidden="true" tabindex="-1"></a>Prior predictive distribution $P0_0(D)=\int P(D∣\theta)P_0​(\theta)d\theta$</span>
<span id="cb75-143"><a href="#cb75-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-144"><a href="#cb75-144" aria-hidden="true" tabindex="-1"></a>Posterior parameter distribution: $P(\theta∣D)$</span>
<span id="cb75-145"><a href="#cb75-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-146"><a href="#cb75-146" aria-hidden="true" tabindex="-1"></a>Posterior predictive distribution: $P(D_n​∣D)=\int P(D_n​∣\theta)P(\theta∣D)d\theta$</span>
<span id="cb75-147"><a href="#cb75-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-148"><a href="#cb75-148" aria-hidden="true" tabindex="-1"></a>We also have some other distributions that follow from these. For example, - the distributions of the model expectations (i.e., the predicted means)</span>
<span id="cb75-149"><a href="#cb75-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-150"><a href="#cb75-150" aria-hidden="true" tabindex="-1"></a><span class="fu">### Likelihood distributions.</span></span>
<span id="cb75-151"><a href="#cb75-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-152"><a href="#cb75-152" aria-hidden="true" tabindex="-1"></a>We are approaching Bayesian statistics from a likelihood-based perspective. That is, we situate regression models within the greater context of a likelihood function. (There are ways to do non-parametric Bayesian statistics, which don't focus on likelihoods. We won't get into that right now.)</span>
<span id="cb75-153"><a href="#cb75-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-154"><a href="#cb75-154" aria-hidden="true" tabindex="-1"></a>So far, we have been using the conventional Gaussian likelihood. If we have some variable $y$, we can express it as normally distributed by</span>
<span id="cb75-155"><a href="#cb75-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-156"><a href="#cb75-156" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-157"><a href="#cb75-157" aria-hidden="true" tabindex="-1"></a>\operatorname{Normal}(y \mid \mu, \sigma) = \frac{1}{\sqrt{2 \pi \sigma}} \exp \left( \frac{1}{2} \left( \frac{y - \mu}{\sigma}\right)^2\right),</span>
<span id="cb75-158"><a href="#cb75-158" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-159"><a href="#cb75-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-160"><a href="#cb75-160" aria-hidden="true" tabindex="-1"></a>where $\mu$ is the mean and $\sigma$ is the standard deviation. With this likelihood,</span>
<span id="cb75-161"><a href="#cb75-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-162"><a href="#cb75-162" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\mu \in \mathbb R$</span>
<span id="cb75-163"><a href="#cb75-163" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>the mean can be any real number, ranging from $-\infty$ to $\infty$</span>
<span id="cb75-164"><a href="#cb75-164" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\sigma \in \mathbb R_{&gt; 0}$</span>
<span id="cb75-165"><a href="#cb75-165" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>the standard deviation can take on any real number greater than zero.</span>
<span id="cb75-166"><a href="#cb75-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-167"><a href="#cb75-167" aria-hidden="true" tabindex="-1"></a>It's also the assumption</span>
<span id="cb75-168"><a href="#cb75-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-169"><a href="#cb75-169" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$y \in \mathbb R$</span>
<span id="cb75-170"><a href="#cb75-170" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>the focal variable $y$ can be any real number, ranging from $-\infty$ to $\infty$.</span>
<span id="cb75-171"><a href="#cb75-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-172"><a href="#cb75-172" aria-hidden="true" tabindex="-1"></a>One of the ways we wrote our model formula back in the first file was</span>
<span id="cb75-173"><a href="#cb75-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-174"><a href="#cb75-174" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-175"><a href="#cb75-175" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb75-176"><a href="#cb75-176" aria-hidden="true" tabindex="-1"></a>\text{bill<span class="sc">\_</span>length<span class="sc">\_</span>mm}_i &amp; \sim \operatorname{Normal}(\mu_i, \sigma) <span class="sc">\\</span></span>
<span id="cb75-177"><a href="#cb75-177" aria-hidden="true" tabindex="-1"></a>\mu_i &amp; = \beta_0 + \beta_1 \text{body<span class="sc">\_</span>mass<span class="sc">\_</span>g}_i,</span>
<span id="cb75-178"><a href="#cb75-178" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb75-179"><a href="#cb75-179" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-180"><a href="#cb75-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-181"><a href="#cb75-181" aria-hidden="true" tabindex="-1"></a>and further in the discussion, we updated that equation with the posterior means for our three parameters to</span>
<span id="cb75-182"><a href="#cb75-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-183"><a href="#cb75-183" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-184"><a href="#cb75-184" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb75-185"><a href="#cb75-185" aria-hidden="true" tabindex="-1"></a>\text{bill<span class="sc">\_</span>length<span class="sc">\_</span>mm}_i &amp; \sim \operatorname{Normal}(\mu_i, 2.92) <span class="sc">\\</span></span>
<span id="cb75-186"><a href="#cb75-186" aria-hidden="true" tabindex="-1"></a>\mu_i &amp; = 32.2 + 0.004 \text{body<span class="sc">\_</span>mass<span class="sc">\_</span>g}_i.</span>
<span id="cb75-187"><a href="#cb75-187" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb75-188"><a href="#cb75-188" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-189"><a href="#cb75-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-190"><a href="#cb75-190" aria-hidden="true" tabindex="-1"></a>Before we get into this, though, let's back up and consider an intercept-only model of the form</span>
<span id="cb75-191"><a href="#cb75-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-192"><a href="#cb75-192" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-193"><a href="#cb75-193" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb75-194"><a href="#cb75-194" aria-hidden="true" tabindex="-1"></a>\text{bill<span class="sc">\_</span>length<span class="sc">\_</span>mm}_i &amp; \sim \operatorname{Normal}(\mu_i, \sigma) <span class="sc">\\</span></span>
<span id="cb75-195"><a href="#cb75-195" aria-hidden="true" tabindex="-1"></a>\mu_i &amp; = \beta_0 ,</span>
<span id="cb75-196"><a href="#cb75-196" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb75-197"><a href="#cb75-197" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-198"><a href="#cb75-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-199"><a href="#cb75-199" aria-hidden="true" tabindex="-1"></a>where there is no predictor variable. Here's how to fit the model with <span class="in">`brm()`</span>.</span>
<span id="cb75-200"><a href="#cb75-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-201"><a href="#cb75-201" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fit0.b, results = "hide"}</span></span>
<span id="cb75-202"><a href="#cb75-202" aria-hidden="true" tabindex="-1"></a><span class="in"># Bayes</span></span>
<span id="cb75-203"><a href="#cb75-203" aria-hidden="true" tabindex="-1"></a><span class="in">fit0.b &lt;- brm(</span></span>
<span id="cb75-204"><a href="#cb75-204" aria-hidden="true" tabindex="-1"></a><span class="in">  data = chinstrap,</span></span>
<span id="cb75-205"><a href="#cb75-205" aria-hidden="true" tabindex="-1"></a><span class="in">  bill_length_mm ~ 1</span></span>
<span id="cb75-206"><a href="#cb75-206" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb75-207"><a href="#cb75-207" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-208"><a href="#cb75-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-209"><a href="#cb75-209" aria-hidden="true" tabindex="-1"></a>Let's look at the model summary.</span>
<span id="cb75-210"><a href="#cb75-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-213"><a href="#cb75-213" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-214"><a href="#cb75-214" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit0.b)</span>
<span id="cb75-215"><a href="#cb75-215" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-216"><a href="#cb75-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-217"><a href="#cb75-217" aria-hidden="true" tabindex="-1"></a>The intercept parameter $\beta_0$ is a stand-in for $\mu$. The $\sigma$ parameter is just $\sigma$. Here they are in a plot.</span>
<span id="cb75-218"><a href="#cb75-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-219"><a href="#cb75-219" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = F}</span></span>
<span id="cb75-220"><a href="#cb75-220" aria-hidden="true" tabindex="-1"></a><span class="in">draws &lt;- as_draws_df(fit0.b) </span></span>
<span id="cb75-221"><a href="#cb75-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-222"><a href="#cb75-222" aria-hidden="true" tabindex="-1"></a><span class="in">draws %&gt;% </span></span>
<span id="cb75-223"><a href="#cb75-223" aria-hidden="true" tabindex="-1"></a><span class="in">  rename(`beta[0]==mu` = b_Intercept) %&gt;% </span></span>
<span id="cb75-224"><a href="#cb75-224" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(`beta[0]==mu`:sigma, names_to = "parameter") %&gt;% </span></span>
<span id="cb75-225"><a href="#cb75-225" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb75-226"><a href="#cb75-226" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = value)) +</span></span>
<span id="cb75-227"><a href="#cb75-227" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_halfeye(.width = .95, normalize = "panels") +</span></span>
<span id="cb75-228"><a href="#cb75-228" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_y_continuous(NULL, breaks = NULL) +</span></span>
<span id="cb75-229"><a href="#cb75-229" aria-hidden="true" tabindex="-1"></a><span class="in">  xlab("parameter space") +</span></span>
<span id="cb75-230"><a href="#cb75-230" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~ parameter, scales = "free", labeller = label_parsed)</span></span>
<span id="cb75-231"><a href="#cb75-231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-232"><a href="#cb75-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-233"><a href="#cb75-233" aria-hidden="true" tabindex="-1"></a>Here are the posterior means for those two parameters.</span>
<span id="cb75-234"><a href="#cb75-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-237"><a href="#cb75-237" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-238"><a href="#cb75-238" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">mean</span>(draws<span class="sc">$</span>b_Intercept)</span>
<span id="cb75-239"><a href="#cb75-239" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">mean</span>(draws<span class="sc">$</span>sigma)</span>
<span id="cb75-240"><a href="#cb75-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-241"><a href="#cb75-241" aria-hidden="true" tabindex="-1"></a>mu; sigma</span>
<span id="cb75-242"><a href="#cb75-242" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-243"><a href="#cb75-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-244"><a href="#cb75-244" aria-hidden="true" tabindex="-1"></a>We can use <span class="in">`dnorm()`</span> to compute the shape of $\operatorname{Normal}(48.8, 3.4)$.</span>
<span id="cb75-245"><a href="#cb75-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-248"><a href="#cb75-248" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-249"><a href="#cb75-249" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">y =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">30</span>, <span class="at">to =</span> <span class="dv">70</span>, <span class="at">by =</span> <span class="fl">0.1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb75-250"><a href="#cb75-250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density =</span> <span class="fu">dnorm</span>(<span class="at">x =</span> y, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma)) <span class="sc">%&gt;%</span> </span>
<span id="cb75-251"><a href="#cb75-251" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-252"><a href="#cb75-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> y, <span class="at">y =</span> density)) <span class="sc">+</span></span>
<span id="cb75-253"><a href="#cb75-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb75-254"><a href="#cb75-254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"bill_length_mm"</span>)</span>
<span id="cb75-255"><a href="#cb75-255" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-256"><a href="#cb75-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-257"><a href="#cb75-257" aria-hidden="true" tabindex="-1"></a>We can compare this to the sample distribution of the <span class="in">`bill_length_mm`</span> data:</span>
<span id="cb75-258"><a href="#cb75-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-261"><a href="#cb75-261" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-262"><a href="#cb75-262" aria-hidden="true" tabindex="-1"></a>chinstrap <span class="sc">%&gt;%</span> </span>
<span id="cb75-263"><a href="#cb75-263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm)) <span class="sc">+</span></span>
<span id="cb75-264"><a href="#cb75-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)),</span>
<span id="cb75-265"><a href="#cb75-265" aria-hidden="true" tabindex="-1"></a>                 <span class="at">binwidth =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb75-266"><a href="#cb75-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">bill_length_mm =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">30</span>, <span class="at">to =</span> <span class="dv">70</span>, <span class="at">by =</span> <span class="fl">0.1</span>)),</span>
<span id="cb75-267"><a href="#cb75-267" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">dnorm</span>(<span class="at">x =</span> bill_length_mm, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma)),</span>
<span id="cb75-268"><a href="#cb75-268" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>)</span>
<span id="cb75-269"><a href="#cb75-269" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-270"><a href="#cb75-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-271"><a href="#cb75-271" aria-hidden="true" tabindex="-1"></a>It's not a great fit, but not horrible either.</span>
<span id="cb75-272"><a href="#cb75-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-273"><a href="#cb75-273" aria-hidden="true" tabindex="-1"></a>Now let's see what this means for our univariable model <span class="in">`fit1.b`</span>. First, let's learn about the <span class="in">`posterior_summary()`</span> function, which we'll use to save a few posterior means.</span>
<span id="cb75-274"><a href="#cb75-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-277"><a href="#cb75-277" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-278"><a href="#cb75-278" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(fit1.b)</span>
<span id="cb75-279"><a href="#cb75-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-280"><a href="#cb75-280" aria-hidden="true" tabindex="-1"></a>b0    <span class="ot">&lt;-</span> <span class="fu">posterior_summary</span>(fit1.b)[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb75-281"><a href="#cb75-281" aria-hidden="true" tabindex="-1"></a>b1    <span class="ot">&lt;-</span> <span class="fu">posterior_summary</span>(fit1.b)[<span class="dv">2</span>, <span class="dv">1</span>]</span>
<span id="cb75-282"><a href="#cb75-282" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">posterior_summary</span>(fit1.b)[<span class="dv">3</span>, <span class="dv">1</span>]</span>
<span id="cb75-283"><a href="#cb75-283" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-284"><a href="#cb75-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-285"><a href="#cb75-285" aria-hidden="true" tabindex="-1"></a>Now we plot.</span>
<span id="cb75-286"><a href="#cb75-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-289"><a href="#cb75-289" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-290"><a href="#cb75-290" aria-hidden="true" tabindex="-1"></a><span class="fu">crossing</span>(<span class="at">body_mass_g    =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">2500</span>, <span class="at">to =</span> <span class="dv">5000</span>, <span class="at">length.out =</span> <span class="dv">200</span>),</span>
<span id="cb75-291"><a href="#cb75-291" aria-hidden="true" tabindex="-1"></a>         <span class="at">bill_length_mm =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">35</span>, <span class="at">to =</span> <span class="dv">60</span>, <span class="at">length.out =</span> <span class="dv">200</span>))  <span class="sc">%&gt;%</span> </span>
<span id="cb75-292"><a href="#cb75-292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density =</span> <span class="fu">dnorm</span>(<span class="at">x =</span> bill_length_mm, </span>
<span id="cb75-293"><a href="#cb75-293" aria-hidden="true" tabindex="-1"></a>                         <span class="at">mean =</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> body_mass_g,</span>
<span id="cb75-294"><a href="#cb75-294" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sd =</span> sigma)) <span class="sc">%&gt;%</span> </span>
<span id="cb75-295"><a href="#cb75-295" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-296"><a href="#cb75-296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g, <span class="at">y =</span> bill_length_mm)) <span class="sc">+</span></span>
<span id="cb75-297"><a href="#cb75-297" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">fill =</span> density),</span>
<span id="cb75-298"><a href="#cb75-298" aria-hidden="true" tabindex="-1"></a>              <span class="at">interpolate =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb75-299"><a href="#cb75-299" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> chinstrap,</span>
<span id="cb75-300"><a href="#cb75-300" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">fill =</span> <span class="st">"black"</span>, <span class="at">stroke =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb75-301"><a href="#cb75-301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"A"</span>, <span class="at">begin =</span> .<span class="dv">15</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb75-302"><a href="#cb75-302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">range</span>(chinstrap<span class="sc">$</span>body_mass_g),</span>
<span id="cb75-303"><a href="#cb75-303" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">range</span>(chinstrap<span class="sc">$</span>bill_length_mm))</span>
<span id="cb75-304"><a href="#cb75-304" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-305"><a href="#cb75-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-306"><a href="#cb75-306" aria-hidden="true" tabindex="-1"></a>Our univariable model <span class="in">`fit1.b`</span> can be viewed as something like a 3-dimensional Gaussian hill.</span>
<span id="cb75-307"><a href="#cb75-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-308"><a href="#cb75-308" aria-hidden="true" tabindex="-1"></a><span class="fu">### Prior distributions &amp; Prior predictive distributions.</span></span>
<span id="cb75-309"><a href="#cb75-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-310"><a href="#cb75-310" aria-hidden="true" tabindex="-1"></a>Let's hold off on this for a bit.</span>
<span id="cb75-311"><a href="#cb75-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-312"><a href="#cb75-312" aria-hidden="true" tabindex="-1"></a><span class="fu">### Parameter distributions.</span></span>
<span id="cb75-313"><a href="#cb75-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-314"><a href="#cb75-314" aria-hidden="true" tabindex="-1"></a>Up above, we plotted the posterior distributions for our intercept-only <span class="in">`fit0.b`</span> model. Here they are again.</span>
<span id="cb75-315"><a href="#cb75-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-316"><a href="#cb75-316" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = F}</span></span>
<span id="cb75-317"><a href="#cb75-317" aria-hidden="true" tabindex="-1"></a><span class="in">draws %&gt;% </span></span>
<span id="cb75-318"><a href="#cb75-318" aria-hidden="true" tabindex="-1"></a><span class="in">  rename(`beta[0]==mu` = b_Intercept) %&gt;% </span></span>
<span id="cb75-319"><a href="#cb75-319" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(`beta[0]==mu`:sigma, names_to = "parameter") %&gt;% </span></span>
<span id="cb75-320"><a href="#cb75-320" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb75-321"><a href="#cb75-321" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = value)) +</span></span>
<span id="cb75-322"><a href="#cb75-322" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_halfeye(.width = .99, normalize = "panels",</span></span>
<span id="cb75-323"><a href="#cb75-323" aria-hidden="true" tabindex="-1"></a><span class="in">               # customize some of the aesthetics</span></span>
<span id="cb75-324"><a href="#cb75-324" aria-hidden="true" tabindex="-1"></a><span class="in">               fill = "lightskyblue1", color = "royalblue", </span></span>
<span id="cb75-325"><a href="#cb75-325" aria-hidden="true" tabindex="-1"></a><span class="in">               point_color = "darkorchid4", point_size = 4, shape = 15) +</span></span>
<span id="cb75-326"><a href="#cb75-326" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_y_continuous(NULL, breaks = NULL) +</span></span>
<span id="cb75-327"><a href="#cb75-327" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "fit0.b",</span></span>
<span id="cb75-328"><a href="#cb75-328" aria-hidden="true" tabindex="-1"></a><span class="in">       subtitle = "This time we used 99% intervals, and got silly with the colors.",</span></span>
<span id="cb75-329"><a href="#cb75-329" aria-hidden="true" tabindex="-1"></a><span class="in">       x = "parameter space") +</span></span>
<span id="cb75-330"><a href="#cb75-330" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~ parameter, scales = "free", labeller = label_parsed)</span></span>
<span id="cb75-331"><a href="#cb75-331" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-332"><a href="#cb75-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-333"><a href="#cb75-333" aria-hidden="true" tabindex="-1"></a>We might practice making a similar plot for our univariable model <span class="in">`fit1.b`</span>.</span>
<span id="cb75-334"><a href="#cb75-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-335"><a href="#cb75-335" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = F}</span></span>
<span id="cb75-336"><a href="#cb75-336" aria-hidden="true" tabindex="-1"></a><span class="in">as_draws_df(fit1.b) %&gt;% </span></span>
<span id="cb75-337"><a href="#cb75-337" aria-hidden="true" tabindex="-1"></a><span class="in">  rename(`beta[0]` = b_Intercept,</span></span>
<span id="cb75-338"><a href="#cb75-338" aria-hidden="true" tabindex="-1"></a><span class="in">         `beta[1]` = b_body_mass_g) %&gt;% </span></span>
<span id="cb75-339"><a href="#cb75-339" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(cols = c(`beta[0]`, `beta[1]`, sigma), </span></span>
<span id="cb75-340"><a href="#cb75-340" aria-hidden="true" tabindex="-1"></a><span class="in">               names_to = "parameter") %&gt;% </span></span>
<span id="cb75-341"><a href="#cb75-341" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb75-342"><a href="#cb75-342" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = value)) +</span></span>
<span id="cb75-343"><a href="#cb75-343" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_histinterval(.width = .95, normalize = "panels") +</span></span>
<span id="cb75-344"><a href="#cb75-344" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_y_continuous(NULL, breaks = NULL) +</span></span>
<span id="cb75-345"><a href="#cb75-345" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "fit1.b",</span></span>
<span id="cb75-346"><a href="#cb75-346" aria-hidden="true" tabindex="-1"></a><span class="in">       subtitle = "Using good old 95% intervals, but switching to histograms",</span></span>
<span id="cb75-347"><a href="#cb75-347" aria-hidden="true" tabindex="-1"></a><span class="in">       x = "parameter space") +</span></span>
<span id="cb75-348"><a href="#cb75-348" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~ parameter, scales = "free", labeller = label_parsed)</span></span>
<span id="cb75-349"><a href="#cb75-349" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-350"><a href="#cb75-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-351"><a href="#cb75-351" aria-hidden="true" tabindex="-1"></a>Some authors, like John Kruschke, have a strong preference for plotting their posteriors with histograms, rather than density plots.</span>
<span id="cb75-352"><a href="#cb75-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-353"><a href="#cb75-353" aria-hidden="true" tabindex="-1"></a><span class="fu">## Distributions of the model expectations.</span></span>
<span id="cb75-354"><a href="#cb75-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-355"><a href="#cb75-355" aria-hidden="true" tabindex="-1"></a>Take another look at the <span class="in">`conditional_effects()`</span> plot from earlier.</span>
<span id="cb75-356"><a href="#cb75-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-359"><a href="#cb75-359" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-360"><a href="#cb75-360" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(fit1.b) <span class="sc">%&gt;%</span> </span>
<span id="cb75-361"><a href="#cb75-361" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">points =</span> <span class="cn">TRUE</span>)</span>
<span id="cb75-362"><a href="#cb75-362" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-363"><a href="#cb75-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-364"><a href="#cb75-364" aria-hidden="true" tabindex="-1"></a>The blue line is the posterior mean, for the $\mu_i$, the model-based mean for <span class="in">`bill_length_mm`</span>, given the value for the predictor <span class="in">`body_mass_g`</span>. The semitransparent gray ribbon marks the percentile-based interval for the conditional mean.</span>
<span id="cb75-365"><a href="#cb75-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-366"><a href="#cb75-366" aria-hidden="true" tabindex="-1"></a>We can make a similar plot with the <span class="in">`fitted()`</span> function. First we'll need a predictor grid, we'll call <span class="in">`nd`</span>.</span>
<span id="cb75-367"><a href="#cb75-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-370"><a href="#cb75-370" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-371"><a href="#cb75-371" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">body_mass_g =</span> <span class="fu">seq</span>(</span>
<span id="cb75-372"><a href="#cb75-372" aria-hidden="true" tabindex="-1"></a>  <span class="at">from =</span> <span class="fu">min</span>(chinstrap<span class="sc">$</span>body_mass_g),</span>
<span id="cb75-373"><a href="#cb75-373" aria-hidden="true" tabindex="-1"></a>  <span class="at">to =</span> <span class="fu">max</span>(chinstrap<span class="sc">$</span>body_mass_g),</span>
<span id="cb75-374"><a href="#cb75-374" aria-hidden="true" tabindex="-1"></a>  <span class="at">length.out =</span> <span class="dv">100</span>))</span>
<span id="cb75-375"><a href="#cb75-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-376"><a href="#cb75-376" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(nd)</span>
<span id="cb75-377"><a href="#cb75-377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-378"><a href="#cb75-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-379"><a href="#cb75-379" aria-hidden="true" tabindex="-1"></a>Now pump <span class="in">`nd`</span> into the <span class="in">`fitted()`</span> function.</span>
<span id="cb75-380"><a href="#cb75-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-383"><a href="#cb75-383" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-384"><a href="#cb75-384" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(fit1.b, <span class="at">newdata =</span> nd) <span class="sc">%&gt;%</span> </span>
<span id="cb75-385"><a href="#cb75-385" aria-hidden="true" tabindex="-1"></a>  <span class="co"># subset the first 6 rows</span></span>
<span id="cb75-386"><a href="#cb75-386" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span>
<span id="cb75-387"><a href="#cb75-387" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-388"><a href="#cb75-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-389"><a href="#cb75-389" aria-hidden="true" tabindex="-1"></a>Now plot.</span>
<span id="cb75-390"><a href="#cb75-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-393"><a href="#cb75-393" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-394"><a href="#cb75-394" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(fit1.b, <span class="at">newdata =</span> nd) <span class="sc">%&gt;%</span> </span>
<span id="cb75-395"><a href="#cb75-395" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb75-396"><a href="#cb75-396" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(nd) <span class="sc">%&gt;%</span> </span>
<span id="cb75-397"><a href="#cb75-397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g)) <span class="sc">+</span></span>
<span id="cb75-398"><a href="#cb75-398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb75-399"><a href="#cb75-399" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb75-400"><a href="#cb75-400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate)) <span class="sc">+</span></span>
<span id="cb75-401"><a href="#cb75-401" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add the data</span></span>
<span id="cb75-402"><a href="#cb75-402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> chinstrap,</span>
<span id="cb75-403"><a href="#cb75-403" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> bill_length_mm))</span>
<span id="cb75-404"><a href="#cb75-404" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-405"><a href="#cb75-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-406"><a href="#cb75-406" aria-hidden="true" tabindex="-1"></a>Look what happens if we augment the <span class="in">`probs`</span> argument in <span class="in">`fitted()`</span>.</span>
<span id="cb75-407"><a href="#cb75-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-410"><a href="#cb75-410" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-411"><a href="#cb75-411" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(fit1.b, </span>
<span id="cb75-412"><a href="#cb75-412" aria-hidden="true" tabindex="-1"></a>       <span class="at">newdata =</span> nd,</span>
<span id="cb75-413"><a href="#cb75-413" aria-hidden="true" tabindex="-1"></a>       <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>, .<span class="dv">25</span>, .<span class="dv">75</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb75-414"><a href="#cb75-414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb75-415"><a href="#cb75-415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(nd) <span class="sc">%&gt;%</span> </span>
<span id="cb75-416"><a href="#cb75-416" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g)) <span class="sc">+</span></span>
<span id="cb75-417"><a href="#cb75-417" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 95% range</span></span>
<span id="cb75-418"><a href="#cb75-418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb75-419"><a href="#cb75-419" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb75-420"><a href="#cb75-420" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 50% range</span></span>
<span id="cb75-421"><a href="#cb75-421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Q25, <span class="at">ymax =</span> Q75),</span>
<span id="cb75-422"><a href="#cb75-422" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb75-423"><a href="#cb75-423" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate)) <span class="sc">+</span></span>
<span id="cb75-424"><a href="#cb75-424" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> chinstrap,</span>
<span id="cb75-425"><a href="#cb75-425" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> bill_length_mm))</span>
<span id="cb75-426"><a href="#cb75-426" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-427"><a href="#cb75-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-428"><a href="#cb75-428" aria-hidden="true" tabindex="-1"></a>Now look what happens if we set <span class="in">`summary = FALSE`</span>.</span>
<span id="cb75-429"><a href="#cb75-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-432"><a href="#cb75-432" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-433"><a href="#cb75-433" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(fit1.b, </span>
<span id="cb75-434"><a href="#cb75-434" aria-hidden="true" tabindex="-1"></a>       <span class="at">newdata =</span> nd,</span>
<span id="cb75-435"><a href="#cb75-435" aria-hidden="true" tabindex="-1"></a>       <span class="at">summary =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb75-436"><a href="#cb75-436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str</span>()</span>
<span id="cb75-437"><a href="#cb75-437" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-438"><a href="#cb75-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-439"><a href="#cb75-439" aria-hidden="true" tabindex="-1"></a>We get full 4,000 draw posterior distributions for each of the 100 levels of the predictor <span class="in">`body_mass_g`</span>. Now look at what happens if we wrangle that output a little, and plot with aid from <span class="in">`stat_lineribbon()`</span> from the **ggdist** package.</span>
<span id="cb75-440"><a href="#cb75-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-443"><a href="#cb75-443" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-444"><a href="#cb75-444" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(fit1.b, </span>
<span id="cb75-445"><a href="#cb75-445" aria-hidden="true" tabindex="-1"></a>       <span class="at">newdata =</span> nd,</span>
<span id="cb75-446"><a href="#cb75-446" aria-hidden="true" tabindex="-1"></a>       <span class="at">summary =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb75-447"><a href="#cb75-447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb75-448"><a href="#cb75-448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">pull</span>(nd, body_mass_g)) <span class="sc">%&gt;%</span> </span>
<span id="cb75-449"><a href="#cb75-449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">draw =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb75-450"><a href="#cb75-450" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>draw) <span class="sc">%&gt;%</span> </span>
<span id="cb75-451"><a href="#cb75-451" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">body_mass_g =</span> <span class="fu">as.double</span>(name)) <span class="sc">%&gt;%</span></span>
<span id="cb75-452"><a href="#cb75-452" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-453"><a href="#cb75-453" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb75-454"><a href="#cb75-454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_lineribbon</span>() <span class="sc">+</span></span>
<span id="cb75-455"><a href="#cb75-455" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>() <span class="sc">+</span></span>
<span id="cb75-456"><a href="#cb75-456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">range</span>(chinstrap<span class="sc">$</span>bill_length_mm)) <span class="sc">+</span></span>
<span id="cb75-457"><a href="#cb75-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb75-458"><a href="#cb75-458" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-459"><a href="#cb75-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-460"><a href="#cb75-460" aria-hidden="true" tabindex="-1"></a>Look what happens when we request more intervals in the <span class="in">`.width`</span> argument.</span>
<span id="cb75-461"><a href="#cb75-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-464"><a href="#cb75-464" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-465"><a href="#cb75-465" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(fit1.b, </span>
<span id="cb75-466"><a href="#cb75-466" aria-hidden="true" tabindex="-1"></a>       <span class="at">newdata =</span> nd,</span>
<span id="cb75-467"><a href="#cb75-467" aria-hidden="true" tabindex="-1"></a>       <span class="at">summary =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb75-468"><a href="#cb75-468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb75-469"><a href="#cb75-469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">pull</span>(nd, body_mass_g)) <span class="sc">%&gt;%</span> </span>
<span id="cb75-470"><a href="#cb75-470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">draw =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb75-471"><a href="#cb75-471" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>draw) <span class="sc">%&gt;%</span> </span>
<span id="cb75-472"><a href="#cb75-472" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">body_mass_g =</span> <span class="fu">as.double</span>(name)) <span class="sc">%&gt;%</span></span>
<span id="cb75-473"><a href="#cb75-473" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-474"><a href="#cb75-474" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb75-475"><a href="#cb75-475" aria-hidden="true" tabindex="-1"></a>  <span class="co"># make more ribbons</span></span>
<span id="cb75-476"><a href="#cb75-476" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_lineribbon</span>(<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">2</span>, .<span class="dv">3</span>, .<span class="dv">4</span>, .<span class="dv">5</span>, .<span class="dv">6</span>, .<span class="dv">7</span>, .<span class="dv">8</span>, .<span class="dv">9</span>),</span>
<span id="cb75-477"><a href="#cb75-477" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># remove the line</span></span>
<span id="cb75-478"><a href="#cb75-478" aria-hidden="true" tabindex="-1"></a>                  <span class="at">linewidth =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb75-479"><a href="#cb75-479" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>() <span class="sc">+</span></span>
<span id="cb75-480"><a href="#cb75-480" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">range</span>(chinstrap<span class="sc">$</span>bill_length_mm)) <span class="sc">+</span></span>
<span id="cb75-481"><a href="#cb75-481" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb75-482"><a href="#cb75-482" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-483"><a href="#cb75-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-484"><a href="#cb75-484" aria-hidden="true" tabindex="-1"></a>The conditional mean, $\mu_i$, has its own distribution. We can take this visualization approach even further to make a color gradient.</span>
<span id="cb75-485"><a href="#cb75-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-488"><a href="#cb75-488" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-489"><a href="#cb75-489" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(fit1.b, </span>
<span id="cb75-490"><a href="#cb75-490" aria-hidden="true" tabindex="-1"></a>       <span class="at">newdata =</span> nd,</span>
<span id="cb75-491"><a href="#cb75-491" aria-hidden="true" tabindex="-1"></a>       <span class="at">summary =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb75-492"><a href="#cb75-492" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb75-493"><a href="#cb75-493" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">pull</span>(nd, body_mass_g)) <span class="sc">%&gt;%</span> </span>
<span id="cb75-494"><a href="#cb75-494" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">draw =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb75-495"><a href="#cb75-495" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>draw) <span class="sc">%&gt;%</span> </span>
<span id="cb75-496"><a href="#cb75-496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">body_mass_g =</span> <span class="fu">as.double</span>(name)) <span class="sc">%&gt;%</span></span>
<span id="cb75-497"><a href="#cb75-497" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-498"><a href="#cb75-498" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g, <span class="at">y =</span> value, <span class="at">fill =</span> <span class="fu">after_stat</span>(.width))) <span class="sc">+</span></span>
<span id="cb75-499"><a href="#cb75-499" aria-hidden="true" tabindex="-1"></a>  <span class="co"># make more ribbons</span></span>
<span id="cb75-500"><a href="#cb75-500" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_lineribbon</span>(<span class="at">.width =</span> <span class="fu">ppoints</span>(<span class="dv">50</span>)) <span class="sc">+</span></span>
<span id="cb75-501"><a href="#cb75-501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">limits =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb75-502"><a href="#cb75-502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">range</span>(chinstrap<span class="sc">$</span>bill_length_mm)) <span class="sc">+</span></span>
<span id="cb75-503"><a href="#cb75-503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb75-504"><a href="#cb75-504" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-505"><a href="#cb75-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-506"><a href="#cb75-506" aria-hidden="true" tabindex="-1"></a>For technical details on this visualization approach, go here: <span class="ot">&lt;https://mjskay.github.io/ggdist/articles/lineribbon.html#lineribbon-gradients&gt;</span>.</span>
<span id="cb75-507"><a href="#cb75-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-508"><a href="#cb75-508" aria-hidden="true" tabindex="-1"></a>The **ggdist** package even has an experimental visualization approach that's based on density gradients, rather than interval-width gradients. Since this is experimental, I'm not going to go into the details. But if you're curious and adventurous, you can learn more here: <span class="ot">&lt;https://mjskay.github.io/ggdist/articles/lineribbon.html#lineribbon-density-gradients&gt;</span>.</span>
<span id="cb75-509"><a href="#cb75-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-510"><a href="#cb75-510" aria-hidden="true" tabindex="-1"></a><span class="fu">### Posterior-predictive distributions.</span></span>
<span id="cb75-511"><a href="#cb75-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-512"><a href="#cb75-512" aria-hidden="true" tabindex="-1"></a>The last section showed the posterior distributions for the model expectations (i.e., the conditional means). In the context of the Gaussian distribution, that's $\mu$, or $\mu_i$ in the case of the univariable model <span class="in">`fit1.b`</span>. But the whole Gaussian distribution includes $\mu$ and $\sigma$.</span>
<span id="cb75-513"><a href="#cb75-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-514"><a href="#cb75-514" aria-hidden="true" tabindex="-1"></a>This is where the <span class="in">`predict()`</span> function comes in. First, we compare the <span class="in">`fitted()`</span> output to <span class="in">`predict()`</span>.</span>
<span id="cb75-515"><a href="#cb75-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-518"><a href="#cb75-518" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-519"><a href="#cb75-519" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(fit1.b, <span class="at">newdata =</span> nd) <span class="sc">%&gt;%</span> </span>
<span id="cb75-520"><a href="#cb75-520" aria-hidden="true" tabindex="-1"></a>  <span class="co"># subset the first 6 rows</span></span>
<span id="cb75-521"><a href="#cb75-521" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span>
<span id="cb75-522"><a href="#cb75-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-523"><a href="#cb75-523" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit1.b, <span class="at">newdata =</span> nd) <span class="sc">%&gt;%</span> </span>
<span id="cb75-524"><a href="#cb75-524" aria-hidden="true" tabindex="-1"></a>  <span class="co"># subset the first 6 rows</span></span>
<span id="cb75-525"><a href="#cb75-525" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span>
<span id="cb75-526"><a href="#cb75-526" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-527"><a href="#cb75-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-528"><a href="#cb75-528" aria-hidden="true" tabindex="-1"></a>The posterior means (<span class="in">`Estimate`</span>) are about the same, but the SD's (<span class="in">`Est.Error`</span>) are much larger in the <span class="in">`predict()`</span> output, and the widths of the 95% intervals are too. Let's make a plot.</span>
<span id="cb75-529"><a href="#cb75-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-532"><a href="#cb75-532" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-533"><a href="#cb75-533" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit1.b, <span class="at">newdata =</span> nd) <span class="sc">%&gt;%</span> </span>
<span id="cb75-534"><a href="#cb75-534" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb75-535"><a href="#cb75-535" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(nd) <span class="sc">%&gt;%</span> </span>
<span id="cb75-536"><a href="#cb75-536" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g)) <span class="sc">+</span></span>
<span id="cb75-537"><a href="#cb75-537" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb75-538"><a href="#cb75-538" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb75-539"><a href="#cb75-539" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate)) <span class="sc">+</span></span>
<span id="cb75-540"><a href="#cb75-540" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add the data</span></span>
<span id="cb75-541"><a href="#cb75-541" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> chinstrap,</span>
<span id="cb75-542"><a href="#cb75-542" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> bill_length_mm)) <span class="sc">+</span></span>
<span id="cb75-543"><a href="#cb75-543" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">range</span>(chinstrap<span class="sc">$</span>bill_length_mm))</span>
<span id="cb75-544"><a href="#cb75-544" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-545"><a href="#cb75-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-546"><a href="#cb75-546" aria-hidden="true" tabindex="-1"></a>The gray band is the 95% interval for the entire posterior predictive distribution, not just the mean. In a good model, about 95% of the data points should be within those bands.</span>
<span id="cb75-547"><a href="#cb75-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-548"><a href="#cb75-548" aria-hidden="true" tabindex="-1"></a>Discuss how the jagged lines have to do with the uncertainty in $\sigma$.</span>
<span id="cb75-549"><a href="#cb75-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-550"><a href="#cb75-550" aria-hidden="true" tabindex="-1"></a>If we wanted to, we could integrate the <span class="in">`fitted()`</span>-based conditional posterior mean, with the <span class="in">`predict()`</span>-based posterior-predictive distribution.</span>
<span id="cb75-551"><a href="#cb75-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-554"><a href="#cb75-554" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-555"><a href="#cb75-555" aria-hidden="true" tabindex="-1"></a><span class="co"># save the fitted() results</span></span>
<span id="cb75-556"><a href="#cb75-556" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">fitted</span>(fit1.b, <span class="at">newdata =</span> nd) <span class="sc">%&gt;%</span> </span>
<span id="cb75-557"><a href="#cb75-557" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb75-558"><a href="#cb75-558" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(nd) </span>
<span id="cb75-559"><a href="#cb75-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-560"><a href="#cb75-560" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit1.b, <span class="at">newdata =</span> nd) <span class="sc">%&gt;%</span> </span>
<span id="cb75-561"><a href="#cb75-561" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb75-562"><a href="#cb75-562" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(nd) <span class="sc">%&gt;%</span> </span>
<span id="cb75-563"><a href="#cb75-563" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-564"><a href="#cb75-564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g)) <span class="sc">+</span></span>
<span id="cb75-565"><a href="#cb75-565" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 95% posterior-predictive range</span></span>
<span id="cb75-566"><a href="#cb75-566" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb75-567"><a href="#cb75-567" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb75-568"><a href="#cb75-568" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 95% conditional mean range</span></span>
<span id="cb75-569"><a href="#cb75-569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> f,</span>
<span id="cb75-570"><a href="#cb75-570" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb75-571"><a href="#cb75-571" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb75-572"><a href="#cb75-572" aria-hidden="true" tabindex="-1"></a>  <span class="co"># posterior mean of the conditional mean</span></span>
<span id="cb75-573"><a href="#cb75-573" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> f,</span>
<span id="cb75-574"><a href="#cb75-574" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> Estimate)) <span class="sc">+</span></span>
<span id="cb75-575"><a href="#cb75-575" aria-hidden="true" tabindex="-1"></a>  <span class="co"># original data</span></span>
<span id="cb75-576"><a href="#cb75-576" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> chinstrap,</span>
<span id="cb75-577"><a href="#cb75-577" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> bill_length_mm)) <span class="sc">+</span></span>
<span id="cb75-578"><a href="#cb75-578" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">range</span>(chinstrap<span class="sc">$</span>bill_length_mm))</span>
<span id="cb75-579"><a href="#cb75-579" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-580"><a href="#cb75-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-581"><a href="#cb75-581" aria-hidden="true" tabindex="-1"></a>It's the posterior predictive distribution that we use to predict new data points. For example, here's what happens if we use <span class="in">`predict()`</span> without the <span class="in">`newdata`</span> argument.</span>
<span id="cb75-582"><a href="#cb75-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-585"><a href="#cb75-585" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-586"><a href="#cb75-586" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit1.b) <span class="sc">%&gt;%</span> </span>
<span id="cb75-587"><a href="#cb75-587" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span>
<span id="cb75-588"><a href="#cb75-588" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-589"><a href="#cb75-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-590"><a href="#cb75-590" aria-hidden="true" tabindex="-1"></a>We get posterior predictive summaries for each of the original data points. Here's what happens if we set <span class="in">`summary = FALSE`</span>.</span>
<span id="cb75-591"><a href="#cb75-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-594"><a href="#cb75-594" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-595"><a href="#cb75-595" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit1.b, <span class="at">summary =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb75-596"><a href="#cb75-596" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str</span>()</span>
<span id="cb75-597"><a href="#cb75-597" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-598"><a href="#cb75-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-599"><a href="#cb75-599" aria-hidden="true" tabindex="-1"></a>This time, we got 4,000 posterior draws for each. We can reduce that output with the <span class="in">`ndraws`</span> argument.</span>
<span id="cb75-600"><a href="#cb75-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-603"><a href="#cb75-603" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-604"><a href="#cb75-604" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit1.b, <span class="at">summary =</span> <span class="cn">FALSE</span>, <span class="at">ndraws =</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb75-605"><a href="#cb75-605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str</span>()</span>
<span id="cb75-606"><a href="#cb75-606" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-607"><a href="#cb75-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-608"><a href="#cb75-608" aria-hidden="true" tabindex="-1"></a>Now wrangle and plot.</span>
<span id="cb75-609"><a href="#cb75-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-612"><a href="#cb75-612" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-613"><a href="#cb75-613" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb75-614"><a href="#cb75-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-615"><a href="#cb75-615" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit1.b, <span class="at">summary =</span> <span class="cn">FALSE</span>, <span class="at">ndraws =</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb75-616"><a href="#cb75-616" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb75-617"><a href="#cb75-617" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">draw =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb75-618"><a href="#cb75-618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>draw) <span class="sc">%&gt;%</span> </span>
<span id="cb75-619"><a href="#cb75-619" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">str_remove</span>(name, <span class="st">"X"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.double</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb75-620"><a href="#cb75-620" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(chinstrap <span class="sc">%&gt;%</span> </span>
<span id="cb75-621"><a href="#cb75-621" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">row =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()),</span>
<span id="cb75-622"><a href="#cb75-622" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">join_by</span>(row)) <span class="sc">%&gt;%</span> </span>
<span id="cb75-623"><a href="#cb75-623" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-624"><a href="#cb75-624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g, <span class="at">y =</span> value)) <span class="sc">+</span> </span>
<span id="cb75-625"><a href="#cb75-625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb75-626"><a href="#cb75-626" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"bill_length_mm"</span>) <span class="sc">+</span></span>
<span id="cb75-627"><a href="#cb75-627" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> draw, <span class="at">labeller =</span> label_both)</span>
<span id="cb75-628"><a href="#cb75-628" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-629"><a href="#cb75-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-630"><a href="#cb75-630" aria-hidden="true" tabindex="-1"></a>With <span class="in">`predict()`</span>, we can use the entire posterior-predictive distribution to simulate new data based on the values of our predictor variable(s). To give you a better sense of what's happening under the hood, here's an <span class="in">`as_draws_df()`</span> based alternative.</span>
<span id="cb75-631"><a href="#cb75-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-632"><a href="#cb75-632" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = F}</span></span>
<span id="cb75-633"><a href="#cb75-633" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(1)</span></span>
<span id="cb75-634"><a href="#cb75-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-635"><a href="#cb75-635" aria-hidden="true" tabindex="-1"></a><span class="in"># walk this code through</span></span>
<span id="cb75-636"><a href="#cb75-636" aria-hidden="true" tabindex="-1"></a><span class="in">as_draws_df(fit1.b) %&gt;% </span></span>
<span id="cb75-637"><a href="#cb75-637" aria-hidden="true" tabindex="-1"></a><span class="in">  rename(beta0 = b_Intercept,</span></span>
<span id="cb75-638"><a href="#cb75-638" aria-hidden="true" tabindex="-1"></a><span class="in">         beta1 = b_body_mass_g) %&gt;% </span></span>
<span id="cb75-639"><a href="#cb75-639" aria-hidden="true" tabindex="-1"></a><span class="in">  select(.draw, beta0, beta1, sigma) %&gt;% </span></span>
<span id="cb75-640"><a href="#cb75-640" aria-hidden="true" tabindex="-1"></a><span class="in">  slice_sample(n = 6) %&gt;% </span></span>
<span id="cb75-641"><a href="#cb75-641" aria-hidden="true" tabindex="-1"></a><span class="in">  expand_grid(chinstrap %&gt;% select(body_mass_g)) %&gt;% </span></span>
<span id="cb75-642"><a href="#cb75-642" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(bill_length_mm = rnorm(n = n(),</span></span>
<span id="cb75-643"><a href="#cb75-643" aria-hidden="true" tabindex="-1"></a><span class="in">                                mean = beta0 + beta1 * body_mass_g,</span></span>
<span id="cb75-644"><a href="#cb75-644" aria-hidden="true" tabindex="-1"></a><span class="in">                                sd = sigma)) %&gt;% </span></span>
<span id="cb75-645"><a href="#cb75-645" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb75-646"><a href="#cb75-646" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = body_mass_g, y = bill_length_mm)) + </span></span>
<span id="cb75-647"><a href="#cb75-647" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point() +</span></span>
<span id="cb75-648"><a href="#cb75-648" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~ .draw, labeller = label_both)</span></span>
<span id="cb75-649"><a href="#cb75-649" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-650"><a href="#cb75-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-651"><a href="#cb75-651" aria-hidden="true" tabindex="-1"></a>Now take a look at what happens when we plot the densities of several simulated draws.</span>
<span id="cb75-652"><a href="#cb75-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-653"><a href="#cb75-653" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = F}</span></span>
<span id="cb75-654"><a href="#cb75-654" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(1)</span></span>
<span id="cb75-655"><a href="#cb75-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-656"><a href="#cb75-656" aria-hidden="true" tabindex="-1"></a><span class="in">as_draws_df(fit1.b) %&gt;% </span></span>
<span id="cb75-657"><a href="#cb75-657" aria-hidden="true" tabindex="-1"></a><span class="in">  rename(beta0 = b_Intercept,</span></span>
<span id="cb75-658"><a href="#cb75-658" aria-hidden="true" tabindex="-1"></a><span class="in">         beta1 = b_body_mass_g) %&gt;% </span></span>
<span id="cb75-659"><a href="#cb75-659" aria-hidden="true" tabindex="-1"></a><span class="in">  select(.draw, beta0, beta1, sigma) %&gt;% </span></span>
<span id="cb75-660"><a href="#cb75-660" aria-hidden="true" tabindex="-1"></a><span class="in">  slice_sample(n = 50) %&gt;%  # increase the number of random draws</span></span>
<span id="cb75-661"><a href="#cb75-661" aria-hidden="true" tabindex="-1"></a><span class="in">  expand_grid(chinstrap %&gt;% select(body_mass_g)) %&gt;% </span></span>
<span id="cb75-662"><a href="#cb75-662" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(bill_length_mm = rnorm(n = n(),</span></span>
<span id="cb75-663"><a href="#cb75-663" aria-hidden="true" tabindex="-1"></a><span class="in">                                mean = beta0 + beta1 * body_mass_g,</span></span>
<span id="cb75-664"><a href="#cb75-664" aria-hidden="true" tabindex="-1"></a><span class="in">                                sd = sigma)) %&gt;% </span></span>
<span id="cb75-665"><a href="#cb75-665" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb75-666"><a href="#cb75-666" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = bill_length_mm, group = .draw)) + </span></span>
<span id="cb75-667"><a href="#cb75-667" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_density(size = 1/4, color = alpha("black", 1/2)) +</span></span>
<span id="cb75-668"><a href="#cb75-668" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim = range(chinstrap$bill_length_mm) + c(-2, 2))</span></span>
<span id="cb75-669"><a href="#cb75-669" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-670"><a href="#cb75-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-671"><a href="#cb75-671" aria-hidden="true" tabindex="-1"></a>The similarities and differences among the individual density lines give you a sense of the (un)certainty of the posterior-predictive distribution.</span>
<span id="cb75-672"><a href="#cb75-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-673"><a href="#cb75-673" aria-hidden="true" tabindex="-1"></a>**This may be a good time for you to work on Exercise 1 (see end of the document)**</span>
<span id="cb75-674"><a href="#cb75-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-675"><a href="#cb75-675" aria-hidden="true" tabindex="-1"></a>#Part 4: Beginning to look at priors</span>
<span id="cb75-676"><a href="#cb75-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-677"><a href="#cb75-677" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bayes' rule</span></span>
<span id="cb75-678"><a href="#cb75-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-679"><a href="#cb75-679" aria-hidden="true" tabindex="-1"></a>Bayes' theorem will allow us to determine the plausibility of various values of our parameter(s) of interest, $\theta$, given the data $d$, which we can express formally as $\Pr(\theta \mid d)$. Bayes' rule takes on the form</span>
<span id="cb75-680"><a href="#cb75-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-681"><a href="#cb75-681" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-682"><a href="#cb75-682" aria-hidden="true" tabindex="-1"></a>\Pr(\theta \mid d) = \frac{\Pr(d \mid \theta) \Pr(\theta)}{\Pr(d)}.</span>
<span id="cb75-683"><a href="#cb75-683" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-684"><a href="#cb75-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-685"><a href="#cb75-685" aria-hidden="true" tabindex="-1"></a>where</span>
<span id="cb75-686"><a href="#cb75-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-687"><a href="#cb75-687" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\Pr(d \mid \theta)$ is the *likelihood*,</span>
<span id="cb75-688"><a href="#cb75-688" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\Pr(\theta)$ is the *prior*,</span>
<span id="cb75-689"><a href="#cb75-689" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\Pr(d)$ is the *average probability of the data*, and</span>
<span id="cb75-690"><a href="#cb75-690" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\Pr(\theta \mid d)$ is the *posterior*.</span>
<span id="cb75-691"><a href="#cb75-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-692"><a href="#cb75-692" aria-hidden="true" tabindex="-1"></a>We can express this in words as</span>
<span id="cb75-693"><a href="#cb75-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-694"><a href="#cb75-694" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-695"><a href="#cb75-695" aria-hidden="true" tabindex="-1"></a>\text{Posterior} = \frac{\text{Probability of the data} \times \text{Prior}}{\text{Average probability of the data}}.</span>
<span id="cb75-696"><a href="#cb75-696" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-697"><a href="#cb75-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-698"><a href="#cb75-698" aria-hidden="true" tabindex="-1"></a>The denominator $\Pr(d)$ is a normalizing constant, and dividing by this constant is what converts the posterior $\Pr(\theta \mid d)$ into a probability metric.</span>
<span id="cb75-699"><a href="#cb75-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-700"><a href="#cb75-700" aria-hidden="true" tabindex="-1"></a><span class="fu">## Default priors</span></span>
<span id="cb75-701"><a href="#cb75-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-702"><a href="#cb75-702" aria-hidden="true" tabindex="-1"></a>To set your priors with **brms**, the <span class="in">`brm()`</span> function has a <span class="in">`prior`</span> argument. If you don't explicitly use the <span class="in">`prior`</span> argument, <span class="in">`brm()`</span> will use default priors. This is what happened with our <span class="in">`fit1.b`</span> model from above. We used default priors. If you'd like to see what those priors are, execute <span class="in">`fit1.b$prior`</span>.</span>
<span id="cb75-703"><a href="#cb75-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-706"><a href="#cb75-706" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-707"><a href="#cb75-707" aria-hidden="true" tabindex="-1"></a><span class="co"># maybe show str(fit1.b)</span></span>
<span id="cb75-708"><a href="#cb75-708" aria-hidden="true" tabindex="-1"></a>fit1.b<span class="sc">$</span>prior</span>
<span id="cb75-709"><a href="#cb75-709" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-710"><a href="#cb75-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-711"><a href="#cb75-711" aria-hidden="true" tabindex="-1"></a>Thus, a fuller expression of our model is</span>
<span id="cb75-712"><a href="#cb75-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-713"><a href="#cb75-713" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-714"><a href="#cb75-714" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb75-715"><a href="#cb75-715" aria-hidden="true" tabindex="-1"></a>\text{bill<span class="sc">\_</span>length<span class="sc">\_</span>mm}_i &amp; \sim \operatorname{Normal}(\mu_i, \sigma) <span class="sc">\\</span></span>
<span id="cb75-716"><a href="#cb75-716" aria-hidden="true" tabindex="-1"></a>\mu_i &amp; = \beta_0 + \beta_1 \text{body<span class="sc">\_</span>mass<span class="sc">\_</span>g}_i <span class="sc">\\</span></span>
<span id="cb75-717"><a href="#cb75-717" aria-hidden="true" tabindex="-1"></a>\beta_0 &amp; \sim \operatorname{Student-t}(3, 49.5, 3.6) <span class="sc">\\</span></span>
<span id="cb75-718"><a href="#cb75-718" aria-hidden="true" tabindex="-1"></a>\beta_1 &amp; \sim \operatorname{Uniform}(-\infty, \infty) <span class="sc">\\</span></span>
<span id="cb75-719"><a href="#cb75-719" aria-hidden="true" tabindex="-1"></a>\sigma &amp; \sim \operatorname{Student-t}^+(3, 0, 3.6).</span>
<span id="cb75-720"><a href="#cb75-720" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb75-721"><a href="#cb75-721" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-722"><a href="#cb75-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-723"><a href="#cb75-723" aria-hidden="true" tabindex="-1"></a>If we had wanted to see the <span class="in">`brm()`</span> defaults before fitting the model, we could have used the <span class="in">`get_prior()`</span> function.</span>
<span id="cb75-724"><a href="#cb75-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-727"><a href="#cb75-727" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-728"><a href="#cb75-728" aria-hidden="true" tabindex="-1"></a><span class="fu">get_prior</span>(</span>
<span id="cb75-729"><a href="#cb75-729" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> chinstrap,</span>
<span id="cb75-730"><a href="#cb75-730" aria-hidden="true" tabindex="-1"></a>  bill_length_mm <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> body_mass_g</span>
<span id="cb75-731"><a href="#cb75-731" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb75-732"><a href="#cb75-732" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-733"><a href="#cb75-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-734"><a href="#cb75-734" aria-hidden="true" tabindex="-1"></a>If you recall, the normal distribution is a member of the Student-t family, where the $\nu$ (aka degrees of freedom or normality parameter) is set to $\infty$. To give you a sense, here are the densities of three members of the Student-t family, with varying $\nu$ values.</span>
<span id="cb75-735"><a href="#cb75-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-738"><a href="#cb75-738" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-739"><a href="#cb75-739" aria-hidden="true" tabindex="-1"></a><span class="fu">crossing</span>(<span class="at">theta =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="fl">4.5</span>, <span class="at">to =</span> <span class="fl">4.5</span>, <span class="at">length.out =</span> <span class="dv">200</span>),</span>
<span id="cb75-740"><a href="#cb75-740" aria-hidden="true" tabindex="-1"></a>         <span class="at">nu =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">10</span>, <span class="cn">Inf</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb75-741"><a href="#cb75-741" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density =</span> <span class="fu">dt</span>(<span class="at">x =</span> theta, <span class="at">df =</span> nu)) <span class="sc">%&gt;%</span> </span>
<span id="cb75-742"><a href="#cb75-742" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-743"><a href="#cb75-743" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> theta, <span class="at">y =</span> density, <span class="at">color =</span> <span class="fu">factor</span>(nu))) <span class="sc">+</span></span>
<span id="cb75-744"><a href="#cb75-744" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb75-745"><a href="#cb75-745" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="fu">expression</span>(nu), <span class="at">option =</span> <span class="st">"A"</span>, <span class="at">end =</span> .<span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb75-746"><a href="#cb75-746" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"3 members of the Student-t family"</span>,</span>
<span id="cb75-747"><a href="#cb75-747" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">expression</span>(theta)) <span class="sc">+</span></span>
<span id="cb75-748"><a href="#cb75-748" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>))</span>
<span id="cb75-749"><a href="#cb75-749" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-750"><a href="#cb75-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-751"><a href="#cb75-751" aria-hidden="true" tabindex="-1"></a>Thus, Student-t distributions have thicker tails when they have smaller $\nu$ parameters. In the case where $\nu = 3$, the tails are pretty thick, which means they are more tolerant of more extreme values. And thus priors with small-$\nu$ parameters will be weaker (i.e., more permissive) than their Gaussian counterparts.</span>
<span id="cb75-752"><a href="#cb75-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-753"><a href="#cb75-753" aria-hidden="true" tabindex="-1"></a>We can visualize functions from **ggdist** to visualize the default <span class="in">`brm()`</span> priors. We'll start with the <span class="in">`student_t(3, 49.5, 3.6)`</span> $\beta_0$ prior, and also take the opportunity to compare that with a slightly stronger <span class="in">`normal(49.5, 3.6)`</span> alternative.</span>
<span id="cb75-754"><a href="#cb75-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-757"><a href="#cb75-757" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-758"><a href="#cb75-758" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="fl">49.5</span>, <span class="fl">3.6</span>)),</span>
<span id="cb75-759"><a href="#cb75-759" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fl">49.5</span>, <span class="fl">3.6</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb75-760"><a href="#cb75-760" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parse_dist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb75-761"><a href="#cb75-761" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-762"><a href="#cb75-762" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">xdist =</span> .dist_obj, <span class="at">y =</span> prior)) <span class="sc">+</span> </span>
<span id="cb75-763"><a href="#cb75-763" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>() <span class="sc">+</span></span>
<span id="cb75-764"><a href="#cb75-764" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">italic</span>(p)(beta[<span class="dv">0</span>])),</span>
<span id="cb75-765"><a href="#cb75-765" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb75-766"><a href="#cb75-766" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">75</span>))</span>
<span id="cb75-767"><a href="#cb75-767" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-768"><a href="#cb75-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-769"><a href="#cb75-769" aria-hidden="true" tabindex="-1"></a>See how that $n = 3$ parameter in the default prior let do much thicker tails than it's Gaussian counterpart. We can make the same kind of plot for our default $\sigma$ prior and its half-Gaussian counterpart.</span>
<span id="cb75-770"><a href="#cb75-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-773"><a href="#cb75-773" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-774"><a href="#cb75-774" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="fl">3.6</span>), <span class="at">lb =</span> <span class="dv">0</span>),  <span class="co"># note our use of the lb = 0 argument</span></span>
<span id="cb75-775"><a href="#cb75-775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">3.6</span>), <span class="at">lb =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb75-776"><a href="#cb75-776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parse_dist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb75-777"><a href="#cb75-777" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-778"><a href="#cb75-778" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">xdist =</span> .dist_obj, <span class="at">y =</span> prior)) <span class="sc">+</span> </span>
<span id="cb75-779"><a href="#cb75-779" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">point_interval =</span> mean_qi, <span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">90</span>, .<span class="dv">99</span>)) <span class="sc">+</span></span>
<span id="cb75-780"><a href="#cb75-780" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">italic</span>(p)(sigma)),</span>
<span id="cb75-781"><a href="#cb75-781" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb75-782"><a href="#cb75-782" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb75-783"><a href="#cb75-783" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-784"><a href="#cb75-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-785"><a href="#cb75-785" aria-hidden="true" tabindex="-1"></a>Here's how we could have explicitly set our priors by hand.</span>
<span id="cb75-786"><a href="#cb75-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-787"><a href="#cb75-787" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fit2.b, message = F, warning = F, results = "hide"}</span></span>
<span id="cb75-788"><a href="#cb75-788" aria-hidden="true" tabindex="-1"></a><span class="in">fit2.b &lt;- brm(</span></span>
<span id="cb75-789"><a href="#cb75-789" aria-hidden="true" tabindex="-1"></a><span class="in">  data = chinstrap,</span></span>
<span id="cb75-790"><a href="#cb75-790" aria-hidden="true" tabindex="-1"></a><span class="in">  bill_length_mm ~ 1 + body_mass_g,</span></span>
<span id="cb75-791"><a href="#cb75-791" aria-hidden="true" tabindex="-1"></a><span class="in">  prior = prior(student_t(3, 49.5, 3.6), class = Intercept) +</span></span>
<span id="cb75-792"><a href="#cb75-792" aria-hidden="true" tabindex="-1"></a><span class="in">    prior(student_t(3, 0, 3.6), class = sigma, lb = 0)</span></span>
<span id="cb75-793"><a href="#cb75-793" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb75-794"><a href="#cb75-794" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-795"><a href="#cb75-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-796"><a href="#cb75-796" aria-hidden="true" tabindex="-1"></a>Compare the results.</span>
<span id="cb75-797"><a href="#cb75-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-800"><a href="#cb75-800" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-801"><a href="#cb75-801" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1.b)</span>
<span id="cb75-802"><a href="#cb75-802" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2.b)</span>
<span id="cb75-803"><a href="#cb75-803" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-804"><a href="#cb75-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-805"><a href="#cb75-805" aria-hidden="true" tabindex="-1"></a><span class="fu">## QUESTION 2 Are the priors the same? What do you think is going on?</span></span>
<span id="cb75-806"><a href="#cb75-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-809"><a href="#cb75-809" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-810"><a href="#cb75-810" aria-hidden="true" tabindex="-1"></a>fit1.b<span class="sc">$</span>prior</span>
<span id="cb75-811"><a href="#cb75-811" aria-hidden="true" tabindex="-1"></a>fit2.b<span class="sc">$</span>prior</span>
<span id="cb75-812"><a href="#cb75-812" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-813"><a href="#cb75-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-814"><a href="#cb75-814" aria-hidden="true" tabindex="-1"></a><span class="fu">### Answer:</span></span>
<span id="cb75-815"><a href="#cb75-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-816"><a href="#cb75-816" aria-hidden="true" tabindex="-1"></a>The priors seem to be the same between these two models. For model 1, all three priors are by default. For model 2, we are specifying the priors for the intercept and for sigma, while we are still using the default prior for the slope.</span>
<span id="cb75-817"><a href="#cb75-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-818"><a href="#cb75-818" aria-hidden="true" tabindex="-1"></a>If you want to learn more about the default prior settings for **brms**, read through the `set_prior` section of the **brms** reference manual (https://CRAN.R-project.org/package=brms/brms.pdf).</span>
<span id="cb75-819"><a href="#cb75-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-820"><a href="#cb75-820" aria-hidden="true" tabindex="-1"></a><span class="fu"># EXERCISE 1</span></span>
<span id="cb75-821"><a href="#cb75-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-822"><a href="#cb75-822" aria-hidden="true" tabindex="-1"></a>In the previous lab, we made a subset of the <span class="in">`penguins`</span> data called <span class="in">`gentoo`</span>, which was only the cases for which <span class="in">`species == "Gentoo"`</span>. Do that again and refit the Bayesian model to those data. Remake some of the figures (From Part 3) in this file with the new version of the model?</span>
<span id="cb75-823"><a href="#cb75-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-824"><a href="#cb75-824" aria-hidden="true" tabindex="-1"></a><span class="fu">### Answer/ Your solution below:</span></span>
<span id="cb75-825"><a href="#cb75-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-826"><a href="#cb75-826" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, results = "hide"}</span></span>
<span id="cb75-827"><a href="#cb75-827" aria-hidden="true" tabindex="-1"></a><span class="in"># subset the data</span></span>
<span id="cb75-828"><a href="#cb75-828" aria-hidden="true" tabindex="-1"></a><span class="in">gentoo = penguins %&gt;% </span></span>
<span id="cb75-829"><a href="#cb75-829" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(species == "Gentoo") %&gt;%</span></span>
<span id="cb75-830"><a href="#cb75-830" aria-hidden="true" tabindex="-1"></a><span class="in">  drop_na(bill_length_mm, body_mass_g)</span></span>
<span id="cb75-831"><a href="#cb75-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-832"><a href="#cb75-832" aria-hidden="true" tabindex="-1"></a><span class="in"># Bayes</span></span>
<span id="cb75-833"><a href="#cb75-833" aria-hidden="true" tabindex="-1"></a><span class="in">fit3.b &lt;- brm(</span></span>
<span id="cb75-834"><a href="#cb75-834" aria-hidden="true" tabindex="-1"></a><span class="in">  data = gentoo,</span></span>
<span id="cb75-835"><a href="#cb75-835" aria-hidden="true" tabindex="-1"></a><span class="in">  bill_length_mm ~ 1 + body_mass_g</span></span>
<span id="cb75-836"><a href="#cb75-836" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb75-837"><a href="#cb75-837" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-838"><a href="#cb75-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-841"><a href="#cb75-841" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-842"><a href="#cb75-842" aria-hidden="true" tabindex="-1"></a><span class="co"># Posterior Means</span></span>
<span id="cb75-843"><a href="#cb75-843" aria-hidden="true" tabindex="-1"></a>b0    <span class="ot">=</span> <span class="fu">posterior_summary</span>(fit3.b)[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb75-844"><a href="#cb75-844" aria-hidden="true" tabindex="-1"></a>b1    <span class="ot">=</span> <span class="fu">posterior_summary</span>(fit3.b)[<span class="dv">2</span>, <span class="dv">1</span>]</span>
<span id="cb75-845"><a href="#cb75-845" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">=</span> <span class="fu">posterior_summary</span>(fit3.b)[<span class="dv">3</span>, <span class="dv">1</span>]</span>
<span id="cb75-846"><a href="#cb75-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-847"><a href="#cb75-847" aria-hidden="true" tabindex="-1"></a><span class="fu">crossing</span>(<span class="at">body_mass_g    =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">3800</span>, <span class="at">to =</span> <span class="dv">6400</span>, <span class="at">length.out =</span> <span class="dv">200</span>),</span>
<span id="cb75-848"><a href="#cb75-848" aria-hidden="true" tabindex="-1"></a>         <span class="at">bill_length_mm =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">40</span>, <span class="at">to =</span> <span class="dv">60</span>, <span class="at">length.out =</span> <span class="dv">200</span>))  <span class="sc">%&gt;%</span> </span>
<span id="cb75-849"><a href="#cb75-849" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density =</span> <span class="fu">dnorm</span>(<span class="at">x =</span> bill_length_mm, </span>
<span id="cb75-850"><a href="#cb75-850" aria-hidden="true" tabindex="-1"></a>                         <span class="at">mean =</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> body_mass_g,</span>
<span id="cb75-851"><a href="#cb75-851" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sd =</span> sigma)) <span class="sc">%&gt;%</span> </span>
<span id="cb75-852"><a href="#cb75-852" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-853"><a href="#cb75-853" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g, <span class="at">y =</span> bill_length_mm)) <span class="sc">+</span></span>
<span id="cb75-854"><a href="#cb75-854" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">fill =</span> density),</span>
<span id="cb75-855"><a href="#cb75-855" aria-hidden="true" tabindex="-1"></a>              <span class="at">interpolate =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb75-856"><a href="#cb75-856" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> gentoo,</span>
<span id="cb75-857"><a href="#cb75-857" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">fill =</span> <span class="st">"black"</span>, <span class="at">stroke =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb75-858"><a href="#cb75-858" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"A"</span>, <span class="at">begin =</span> .<span class="dv">15</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb75-859"><a href="#cb75-859" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">range</span>(gentoo<span class="sc">$</span>body_mass_g),</span>
<span id="cb75-860"><a href="#cb75-860" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">range</span>(gentoo<span class="sc">$</span>bill_length_mm))</span>
<span id="cb75-861"><a href="#cb75-861" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-862"><a href="#cb75-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-863"><a href="#cb75-863" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE}</span></span>
<span id="cb75-864"><a href="#cb75-864" aria-hidden="true" tabindex="-1"></a><span class="in"># Parameter Distributions</span></span>
<span id="cb75-865"><a href="#cb75-865" aria-hidden="true" tabindex="-1"></a><span class="in">as_draws_df(fit3.b) %&gt;% </span></span>
<span id="cb75-866"><a href="#cb75-866" aria-hidden="true" tabindex="-1"></a><span class="in">  rename(`beta[0]` = b_Intercept,</span></span>
<span id="cb75-867"><a href="#cb75-867" aria-hidden="true" tabindex="-1"></a><span class="in">         `beta[1]` = b_body_mass_g) %&gt;% </span></span>
<span id="cb75-868"><a href="#cb75-868" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(cols = c(`beta[0]`, `beta[1]`, sigma), </span></span>
<span id="cb75-869"><a href="#cb75-869" aria-hidden="true" tabindex="-1"></a><span class="in">               names_to = "parameter") %&gt;% </span></span>
<span id="cb75-870"><a href="#cb75-870" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb75-871"><a href="#cb75-871" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = value)) +</span></span>
<span id="cb75-872"><a href="#cb75-872" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_histinterval(.width = .95, normalize = "panels") +</span></span>
<span id="cb75-873"><a href="#cb75-873" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_y_continuous(NULL, breaks = NULL) +</span></span>
<span id="cb75-874"><a href="#cb75-874" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "fit1.b",</span></span>
<span id="cb75-875"><a href="#cb75-875" aria-hidden="true" tabindex="-1"></a><span class="in">       subtitle = "Using good old 95% intervals, but switching to histograms",</span></span>
<span id="cb75-876"><a href="#cb75-876" aria-hidden="true" tabindex="-1"></a><span class="in">       x = "parameter space") +</span></span>
<span id="cb75-877"><a href="#cb75-877" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~ parameter, scales = "free", labeller = label_parsed)</span></span>
<span id="cb75-878"><a href="#cb75-878" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-879"><a href="#cb75-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-882"><a href="#cb75-882" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-883"><a href="#cb75-883" aria-hidden="true" tabindex="-1"></a><span class="co"># Model Expectations</span></span>
<span id="cb75-884"><a href="#cb75-884" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">body_mass_g =</span> <span class="fu">seq</span>(</span>
<span id="cb75-885"><a href="#cb75-885" aria-hidden="true" tabindex="-1"></a>  <span class="at">from =</span> <span class="fu">min</span>(gentoo<span class="sc">$</span>body_mass_g),</span>
<span id="cb75-886"><a href="#cb75-886" aria-hidden="true" tabindex="-1"></a>  <span class="at">to =</span> <span class="fu">max</span>(gentoo<span class="sc">$</span>body_mass_g),</span>
<span id="cb75-887"><a href="#cb75-887" aria-hidden="true" tabindex="-1"></a>  <span class="at">length.out =</span> <span class="dv">100</span>))</span>
<span id="cb75-888"><a href="#cb75-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-889"><a href="#cb75-889" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(fit3.b, <span class="at">newdata =</span> nd) <span class="sc">%&gt;%</span> </span>
<span id="cb75-890"><a href="#cb75-890" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb75-891"><a href="#cb75-891" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(nd) <span class="sc">%&gt;%</span> </span>
<span id="cb75-892"><a href="#cb75-892" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g)) <span class="sc">+</span></span>
<span id="cb75-893"><a href="#cb75-893" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb75-894"><a href="#cb75-894" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb75-895"><a href="#cb75-895" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate)) <span class="sc">+</span></span>
<span id="cb75-896"><a href="#cb75-896" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add the data</span></span>
<span id="cb75-897"><a href="#cb75-897" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> gentoo,</span>
<span id="cb75-898"><a href="#cb75-898" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> bill_length_mm))</span>
<span id="cb75-899"><a href="#cb75-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-900"><a href="#cb75-900" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(fit3.b, </span>
<span id="cb75-901"><a href="#cb75-901" aria-hidden="true" tabindex="-1"></a>       <span class="at">newdata =</span> nd,</span>
<span id="cb75-902"><a href="#cb75-902" aria-hidden="true" tabindex="-1"></a>       <span class="at">summary =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb75-903"><a href="#cb75-903" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb75-904"><a href="#cb75-904" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">pull</span>(nd, body_mass_g)) <span class="sc">%&gt;%</span> </span>
<span id="cb75-905"><a href="#cb75-905" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">draw =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb75-906"><a href="#cb75-906" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>draw) <span class="sc">%&gt;%</span> </span>
<span id="cb75-907"><a href="#cb75-907" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">body_mass_g =</span> <span class="fu">as.double</span>(name)) <span class="sc">%&gt;%</span></span>
<span id="cb75-908"><a href="#cb75-908" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb75-909"><a href="#cb75-909" aria-hidden="true" tabindex="-1"></a>  <span class="co"># make more ribbons</span></span>
<span id="cb75-910"><a href="#cb75-910" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_lineribbon</span>(<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">2</span>, .<span class="dv">3</span>, .<span class="dv">4</span>, .<span class="dv">5</span>, .<span class="dv">6</span>, .<span class="dv">7</span>, .<span class="dv">8</span>, .<span class="dv">9</span>),</span>
<span id="cb75-911"><a href="#cb75-911" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># remove the line</span></span>
<span id="cb75-912"><a href="#cb75-912" aria-hidden="true" tabindex="-1"></a>                  <span class="at">linewidth =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb75-913"><a href="#cb75-913" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>() <span class="sc">+</span></span>
<span id="cb75-914"><a href="#cb75-914" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">range</span>(gentoo<span class="sc">$</span>bill_length_mm)) <span class="sc">+</span></span>
<span id="cb75-915"><a href="#cb75-915" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb75-916"><a href="#cb75-916" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-917"><a href="#cb75-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-920"><a href="#cb75-920" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-921"><a href="#cb75-921" aria-hidden="true" tabindex="-1"></a><span class="co"># Posterior-predictive Distributions</span></span>
<span id="cb75-922"><a href="#cb75-922" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">fitted</span>(fit3.b, <span class="at">newdata =</span> nd) <span class="sc">%&gt;%</span> </span>
<span id="cb75-923"><a href="#cb75-923" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb75-924"><a href="#cb75-924" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(nd) </span>
<span id="cb75-925"><a href="#cb75-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-926"><a href="#cb75-926" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit3.b, <span class="at">newdata =</span> nd) <span class="sc">%&gt;%</span> </span>
<span id="cb75-927"><a href="#cb75-927" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb75-928"><a href="#cb75-928" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(nd) <span class="sc">%&gt;%</span> </span>
<span id="cb75-929"><a href="#cb75-929" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g)) <span class="sc">+</span></span>
<span id="cb75-930"><a href="#cb75-930" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 95% posterior-predictive range</span></span>
<span id="cb75-931"><a href="#cb75-931" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb75-932"><a href="#cb75-932" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb75-933"><a href="#cb75-933" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 95% conditional mean range</span></span>
<span id="cb75-934"><a href="#cb75-934" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> f,</span>
<span id="cb75-935"><a href="#cb75-935" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb75-936"><a href="#cb75-936" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb75-937"><a href="#cb75-937" aria-hidden="true" tabindex="-1"></a>  <span class="co"># posterior mean of the conditional mean</span></span>
<span id="cb75-938"><a href="#cb75-938" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> f,</span>
<span id="cb75-939"><a href="#cb75-939" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> Estimate)) <span class="sc">+</span></span>
<span id="cb75-940"><a href="#cb75-940" aria-hidden="true" tabindex="-1"></a>  <span class="co"># original data</span></span>
<span id="cb75-941"><a href="#cb75-941" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> gentoo,</span>
<span id="cb75-942"><a href="#cb75-942" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> bill_length_mm)) <span class="sc">+</span></span>
<span id="cb75-943"><a href="#cb75-943" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">range</span>(gentoo<span class="sc">$</span>bill_length_mm))</span>
<span id="cb75-944"><a href="#cb75-944" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-945"><a href="#cb75-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-948"><a href="#cb75-948" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-949"><a href="#cb75-949" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit3.b, <span class="at">summary =</span> <span class="cn">FALSE</span>, <span class="at">ndraws =</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb75-950"><a href="#cb75-950" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb75-951"><a href="#cb75-951" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">draw =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb75-952"><a href="#cb75-952" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>draw) <span class="sc">%&gt;%</span> </span>
<span id="cb75-953"><a href="#cb75-953" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">str_remove</span>(name, <span class="st">"X"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.double</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb75-954"><a href="#cb75-954" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(gentoo <span class="sc">%&gt;%</span> </span>
<span id="cb75-955"><a href="#cb75-955" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">row =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()),</span>
<span id="cb75-956"><a href="#cb75-956" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">join_by</span>(row)) <span class="sc">%&gt;%</span> </span>
<span id="cb75-957"><a href="#cb75-957" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> body_mass_g, <span class="at">y =</span> value)) <span class="sc">+</span> </span>
<span id="cb75-958"><a href="#cb75-958" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb75-959"><a href="#cb75-959" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"bill_length_mm"</span>) <span class="sc">+</span></span>
<span id="cb75-960"><a href="#cb75-960" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> draw, <span class="at">labeller =</span> label_both)</span>
<span id="cb75-961"><a href="#cb75-961" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-962"><a href="#cb75-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-963"><a href="#cb75-963" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE}</span></span>
<span id="cb75-964"><a href="#cb75-964" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(1)</span></span>
<span id="cb75-965"><a href="#cb75-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-966"><a href="#cb75-966" aria-hidden="true" tabindex="-1"></a><span class="in">as_draws_df(fit3.b) %&gt;% </span></span>
<span id="cb75-967"><a href="#cb75-967" aria-hidden="true" tabindex="-1"></a><span class="in">  rename(beta0 = b_Intercept,</span></span>
<span id="cb75-968"><a href="#cb75-968" aria-hidden="true" tabindex="-1"></a><span class="in">         beta1 = b_body_mass_g) %&gt;% </span></span>
<span id="cb75-969"><a href="#cb75-969" aria-hidden="true" tabindex="-1"></a><span class="in">  select(.draw, beta0, beta1, sigma) %&gt;% </span></span>
<span id="cb75-970"><a href="#cb75-970" aria-hidden="true" tabindex="-1"></a><span class="in">  slice_sample(n = 50) %&gt;%  # increase the number of random draws</span></span>
<span id="cb75-971"><a href="#cb75-971" aria-hidden="true" tabindex="-1"></a><span class="in">  expand_grid(gentoo %&gt;% select(body_mass_g)) %&gt;% </span></span>
<span id="cb75-972"><a href="#cb75-972" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(bill_length_mm = rnorm(n = n(),</span></span>
<span id="cb75-973"><a href="#cb75-973" aria-hidden="true" tabindex="-1"></a><span class="in">                                mean = beta0 + beta1 * body_mass_g,</span></span>
<span id="cb75-974"><a href="#cb75-974" aria-hidden="true" tabindex="-1"></a><span class="in">                                sd = sigma)) %&gt;% </span></span>
<span id="cb75-975"><a href="#cb75-975" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb75-976"><a href="#cb75-976" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = bill_length_mm, group = .draw)) + </span></span>
<span id="cb75-977"><a href="#cb75-977" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_density(size = 1/4, color = alpha("black", 1/2)) +</span></span>
<span id="cb75-978"><a href="#cb75-978" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_cartesian(xlim = range(gentoo$bill_length_mm) + c(-2, 2))</span></span>
<span id="cb75-979"><a href="#cb75-979" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-980"><a href="#cb75-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-983"><a href="#cb75-983" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-984"><a href="#cb75-984" aria-hidden="true" tabindex="-1"></a><span class="co"># Prior parameter distribution</span></span>
<span id="cb75-985"><a href="#cb75-985" aria-hidden="true" tabindex="-1"></a>fit3.b<span class="sc">$</span>prior</span>
<span id="cb75-986"><a href="#cb75-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-987"><a href="#cb75-987" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="fl">47.3</span>, <span class="fl">3.1</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb75-988"><a href="#cb75-988" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parse_dist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb75-989"><a href="#cb75-989" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-990"><a href="#cb75-990" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">xdist =</span> .dist_obj, <span class="at">y =</span> prior)) <span class="sc">+</span> </span>
<span id="cb75-991"><a href="#cb75-991" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>() <span class="sc">+</span></span>
<span id="cb75-992"><a href="#cb75-992" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">italic</span>(p)(beta[<span class="dv">0</span>])),</span>
<span id="cb75-993"><a href="#cb75-993" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb75-994"><a href="#cb75-994" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">75</span>))</span>
<span id="cb75-995"><a href="#cb75-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-996"><a href="#cb75-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-997"><a href="#cb75-997" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="fl">3.1</span>), <span class="at">lb =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb75-998"><a href="#cb75-998" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parse_dist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb75-999"><a href="#cb75-999" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">xdist =</span> .dist_obj, <span class="at">y =</span> prior)) <span class="sc">+</span> </span>
<span id="cb75-1000"><a href="#cb75-1000" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">point_interval =</span> mean_qi, <span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">90</span>, .<span class="dv">99</span>)) <span class="sc">+</span></span>
<span id="cb75-1001"><a href="#cb75-1001" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">italic</span>(p)(sigma)),</span>
<span id="cb75-1002"><a href="#cb75-1002" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb75-1003"><a href="#cb75-1003" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb75-1004"><a href="#cb75-1004" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-1005"><a href="#cb75-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-1006"><a href="#cb75-1006" aria-hidden="true" tabindex="-1"></a><span class="fu">## References</span></span>
<span id="cb75-1007"><a href="#cb75-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-1008"><a href="#cb75-1008" aria-hidden="true" tabindex="-1"></a>Kruschke, J. K. (2015). *Doing Bayesian data analysis: A tutorial with R, JAGS, and Stan*. Academic Press. <span class="ot">&lt;https://sites.google.com/site/doingbayesiandataanalysis/&gt;</span></span>
<span id="cb75-1009"><a href="#cb75-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-1010"><a href="#cb75-1010" aria-hidden="true" tabindex="-1"></a><span class="fu">## Session information</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>